---
title: "Cotton"
author: "Naidu"
date: "15/02/2021"
output: html_document
---

# 1.Setting  and Gettig Working Directory


```{r setup, include=FALSE}
# Setting Working Directory


setwd("D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT")

#Get Working Directory
getwd()


```

#####################################################################################

#2. Setting the of rquired Packages 


```{r, eval = FALSE, echo= TRUE}

#Required packages 
install.packages("tidyverse")
install.packages("plotrix")
install.packages("reshape", type = "source")
install.packages("reshape2", type = "source")
install.packages(c("xlsx","openxlsx"))
install.packages("writexl", type = "source")
install.packages("openxlsx")
install.packages("officer")
devtools::install_github("omegahat/RDCOMClient")
install.packages("export")
install.packages("R2PPT")
install.packages("rJava")
install.packages("ggpmisc")
install.packages("leaflet")
install.packages("mapview")

install.packages("remotes")
remotes::install_github("xl0418/ggradar2")

install.packages("remotes")
remotes::install_github("ricardo-bion/ggradar")
```

######################################################################################


# 3. Setting the of rquired Libraries 



```{r, eval=TRUE, echo = TRUE, warning=FALSE, message=FALSE,results ="hide"}

# Required Libraries
library(metan)
library(gridExtra)
library(grid)
library(rJava)
library(R2PPT)
library(officer)
library(rvg)
library(writexl)
library(readxl)
library(xlsxjars)
library(xlsx)
library(tidyverse)
library(dplyr)
library(reshape2)
library(lubridate)
library(ggrepel)
library(ggplot2)
library(plotrix)
library(gridExtra)
library(tibble)
library(gridExtra)
library(stringr)
library(tibble)
library(ggpmisc)
library(openxlsx)
library(ggridges)
library(leaflet)
library(ggradar2)
library(ggradar)
library(janitor)
```


######################################################################################

# 4. Creating Sample PPT(Power Point Presentation ) Report  


```{r}
# Sample PPT report 

gg_plot <- ggplot(data = iris ) +
    geom_point(mapping = aes(Sepal.Length, Petal.Length, 
                             color = Species), size = 3) + 
    theme_minimal()

doc <- read_pptx()
doc <- add_slide(doc)
doc <- ph_with(x = doc, value = gg_plot,
               location = ph_location_fullsize() )
doc <- ph_with(x = doc, "a ggplot example",
               location = ph_location_type(
                   type = "title") )
print(doc, target = "example.pptx")

```

######################################################################################


# 5. Import  Data file and preparing  Dataset for Analysis 


```{r}

# Impost Excel file of  2021 Rainy cotton data  

cottonHATData2020 <- read_excel("D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Data/2020-21_HAT_Cotton_SC_Rainy.xlsx", sheet = "HAT")

# Creating new varaibles - Post flowering Stalkrot

cottonData <-cottonHATData2020 %>% 
   mutate( Wiltscore = if_else(Wilt  >= 0 &  Wilt <= 3, 1,
                    if_else(Wilt >3 &  Wilt  <= 5, 2,
                            if_else(Wilt  > 5 & Wilt  <= 10, 3,
                                    if_else( Wilt  > 10 &  Wilt  <= 20, 4,
                                         if_else( Wilt  > 20, 5, 1)))))) %>% 
  arrange(State, Trial, Hybtype, Hybrid)

#Looking  at Data
class(cottonData)
head(cottonData, 10)
tail(cottonData, 10)
dim(cottonData)
colnames(cottonData)
row.names(cottonData)
str(cottonData)

```


######################################################################################

# 6. Map showing Locations of HATs 

```{r}
# HAT locations

library(leaflet)
library(htmlwidgets)
library(mapview)

locationMap <- leaflet(data =cottonData) %>% 
               addTiles() %>%
               addCircleMarkers(~Long, ~Lat,
                radius =  3,
                color =  "black",
                stroke = FALSE, 
                fillOpacity = 0.5,
                popup = paste("State:",cottonData$State, "<br>",
                              "District:",cottonData$District,"<br>",
                              "Village:",cottonData$Village,"<br>",
                              "Sowing Date:",cottonData$Sowingdate))

saveWidget(locationMap, file="D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/General/testmap.html", selfcontained = TRUE)

```
######################################################################################

# 7.Summarizing Trials-State-Wise,Market-wise and Hybrid-wise Trials  

```{r}
# Summary Table of Hybrid-wise Trials

    cotton_Hybrid_Trials = cottonData %>% 
       group_by(Hybrid,Hybtype) %>% 
       summarise( Trials = n(), .groups = "drop") %>% 
       rbind(c("Total","", sum(.$Trials)))


# 6b. State Wise Summary: Trials, Hybrids and Checks Trials  

     stateHybTrials  <- cottonData %>% 
         group_by(State,Hybtype, Hybrid) %>% 
         summarise(Trials = n(), .groups = "drop") %>% 
         gather(key,value, -(c(State,Hybtype, Hybrid))) %>% 
         spread (State,value) %>% 
         mutate("Total Trials" = rowSums(.[4:9],na.rm =TRUE)) %>% 
         select(-key) %>% 
         adorn_totals()
         
    marketwise_trials <-cottonData %>% 
    group_by(State, District, Market) %>% 
    summarise(Trials = sum(Plan),
              Districts  = n_distinct(Trial),
              Markets = n_distinct(Trial), .groups = 'drop') %>% 
    adorn_totals()          

#Print summary of trials

write_xlsx(list(HybridTrials = cotton_Hybrid_Trials,
               StateTrials = stateHybTrials ,
               markettrials = marketwise_trials),
           "D:/ProductDevelopment/R_Projects/Cotton/Cotton_SC/HAT/Results/General/G1_Trial_summary.xlsx")

```



# 8. Summary Tables of Hybrid-wise and State and Hybrid-wise Mean Yield 

######################################################################################


```{r}
# Summary of Hybrids, Trials and Mean Yield 

HybridMeans <- cottonData %>% 
    group_by(Hybrid, Hybtype) %>% 
    summarise( Trials = n(),
               Yield = mean(Yield), .groups = 'drop')

# Summary of State wise Hybrids, Trials and Mean Yield 

HybridStateMeans  <- cottonData %>% 
    group_by(State,Hybrid,Hybtype) %>% 
    summarise( Trials = n(),
               Yield = mean(Yield), .groups = 'drop') %>% 
    arrange(Hybtype,Hybrid)

# Spreading HybridStateMeans  dataset  for states 

HybridStateMeans_2 <- HybridStateMeans%>% 
  gather(key = "Type", value = "Value", -Hybtype, -State, -Hybrid, Trials, Yield) %>% 
  unite(Variable, Type, State) %>% 
  spread(Variable, Value) %>% 
  dplyr::select(Hybtype,
                Hybrid,
                Trials_AP,Yield_AP,
                Trials_GJ,Yield_GJ,
                Trials_KA,Yield_KA,
                Trials_MP,Yield_MP,
                Trials_MR,Yield_MR,
                Trials_TS,Yield_TS,
                everything()) %>% 
  arrange(Hybtype, Hybrid)

  
# HybridStateMeans_2 and HybridStateMeans datasets to create summary table of  
# Hybrids Vs State - Trials and Mean Yield 


HybridStateMeansCombibed <- bind_cols(HybridStateMeans_2,HybridMeans) %>% 
    rename(Hybtype   = Hybtype...1,
           Hybrid    =  Hybrid...2) %>% 
           arrange(Hybtype,Hybrid) %>% 
    mutate_if(is.numeric, round,0) %>% 
    select(-Hybrid...15, - Hybtype...16)

HybridMeans
HybridStateMeans
HybridStateMeansCombibed

write_xlsx(list(Hybridrid_Means = HybridMeans,
                Hybridrid_Vs_State_Means = HybridStateMeans,
                Hybridrid_Vs_State_Means_across = HybridStateMeans_2,
                Hybridrid_State_Hybridrid_Means =  HybridStateMeansCombibed),
           "D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/General/G2_Means_Yield.xlsx")

```




# 9. Summary Tables of Mean Yield of Hybrids in Irrigated and Rainfed conditions 

######################################################################################

```{r}
# Summary Tables of Mean Yield of Hybrids in Irrigated and Rainfed conditions 

 Irrig_rainfed_Means <-cottonData %>% 
    group_by(Cultivation,  Hybrid, Hybtype) %>% 
    summarise( Trials = n(),
               Yield = mean(Yield), .groups = 'drop') %>% 
    gather(key = "Type", value = "Value", -Hybtype, -Hybrid,  -Cultivation , Trials,
                 Yield) %>% 
  unite(Variable,Cultivation, Type) %>% 
  spread(Variable, Value) %>% 
  dplyr::select(Hybtype,everything()) %>% 
  arrange(desc(Hybtype),Hybrid) %>% 
  mutate_if(is.numeric, round,0) 
  

Irrig_rainfed_Means

write_xlsx(list(Irrig_rainfed_Means = Irrig_rainfed_Means),
        "D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/General/G3_Yield_Irrigated.xlsx")


```

# 10. Summary Tables of Mean Yield of Hybrids at Various Spacing Conditions

####################################################################################

```{r}


# Summary Tables of Mean Yield of Hybrids at Various Spacing Conditions
Spacing_Yield <-cottonData %>% 
    select(Trial, Hybrid,Spacing, Rowspacing,Plantspacing, Yield) %>% 
    mutate(Expected_plants = 4048/(Rowspacing *	Plantspacing/10000)) %>% 
    group_by(Spacing, Hybrid) %>% 
            summarize(MeanYield = mean(Yield),.groups= 'drop' ) %>% 
            gather( Type, Value, -Spacing,-Hybrid, MeanYield  ) %>% 
     spread(Hybrid, Value) %>% 
     select(-Type)

#Combining  Yield  and plants/acre
Spacing_Yield_Final<- cottonData %>% 
    select(Trial, Hybrid, Hybtype,Spacing, Rowspacing,Plantspacing, Yield) %>% 
    mutate(Plants_acre = 4048/(Rowspacing *	Plantspacing/10000)) %>% 
    group_by(Spacing) %>% 
            summarize(Plants_acre  = mean(Plants_acre),.groups= 'drop' ) %>% 
    bind_cols(Spacing_Yield) %>% 
    rename(Spacing = Spacing...1) %>% 
           mutate_if(is.numeric, round , 0) %>% 
    arrange(Plants_acre) %>% 
    select(Spacing,Plants_acre, HC20103, HC20105, HC20107, Aatish, Pinaka, Ajooba,
           MC5401, Vega, RCH659, Jadoo, Jangee, Moksha, ATM, MoneyMaker, RCHNeo)

Spacing_Yield_Final

write_xlsx(list(Irrig_rainfed_Means = Spacing_Yield_Final),
        "D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/General/G4_Yield_Spacing.xlsx")

```


# 11. Computing  the CV for Plant Stand and  Yield   

####################################################################################


```{r}

# Method1: Use Aggregate Function to estimate CV for each Trial

CV_PlantstandYield <-  aggregate(cbind(Plantsacre,Yield)~ Trial, 
                                 data =cottonData, FUN = cv) 

#Method2. Create Function for computing CV for each Trial

cv <- function(x) {
  (sd(x)/mean(x))*100
      }
cottonData_cv <-cottonData%>% 
         group_by(Trial)%>%
          dplyr::select(Trial, Plantsacre,Yield) %>% 
          summarise(  Plantstand_CV = cv(Plantsacre),
                      Yield_CV = cv(Yield),na.rm = TRUE, .groups = 'drop')

# Identify the trials those exhibit CV greater than 25  for Plant Stand ot Yield
cottonData_cv_25 <-cottonData_cv %>% 
     filter( Plantstand_CV > 25 | Yield_CV > 25)

#compted means and  CV
write_xlsx(list(CV_Method1 = CV_PlantstandYield ,
                CV_Method2 =cottonData_cv,
                cottonData_cv_21 =cottonData_cv_25),
   
  "D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/General/G5_PlantStand_Yield_CV.xlsx")


```


# 12. Least Square Technique to Adjust Plant Stand  for Yield   

####################################################################################


```{r}

# Deleting  trails which shows high  CV for plant stand  or  Yield 
# No Trial exhibit CV  greater than 
# cottonData <- cottonData%>% 
#    filter( Trial!= "KAMZR11"&Trial!= "KAMZR12"&Trial!= "KAMZRDR03"&Trial!="PBMZR03")



# Least squares Technique:Predict yield for adjusting Yield for plants per acre 


cottonData_final <- cottonData %>% 
    group_by(Trial) %>% 
      do(lm(Yield ~ Plantsacre, data = .) %>% 
           predict %>% 
           data_frame(prediction = .)) %>%
       bind_cols(cottonData, by = c( "Trial")) %>% 
      dplyr::rename(Trial = Trial...1,
                    Predicted_Yield = prediction) %>% 
      dplyr::select(-Trial...7)

# Compute Hybrid means for predicted Yield  and Actual Yield 

predict_actual_Hybrid_Yield_means <- cottonData_final  %>% 
  group_by(Hybrid) %>% 
  summarise(Trials = n(),
            Predicted_Yield = mean( Predicted_Yield),
            Aactual_Yield   = mean(Yield), .groups = 'drop') %>% 
  mutate(Rank_PY = rank(Predicted_Yield),
         Rank_AY = rank( Aactual_Yield )) %>% 
  mutate_if(is.numeric,round, 0)

#Compute Hybrid means for predicted Yield  

predict_actual_State_Yield_means <-cottonData_final  %>% 
  group_by(State, Hybrid) %>% 
  summarise(Trials = n(),
            Predicted_Yield = mean( Predicted_Yield),
            Aactual_Yield   = mean(Yield), .groups = 'drop') %>% 
  mutate_if(is.numeric,round, 0)

predict_actual_Hybrid_Yield_means
predict_actual_State_Yield_means

#Validation  and summerising means  in comparison with Pivot 
write_xlsx(list(predSelect_datset = cottonData_final, 
                PredYield_Hybridrds =predict_actual_Hybrid_Yield_means, 
                Predyield_State_means = predict_actual_State_Yield_means),
           "D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/General/G8_Predict_Yield_Means.xlsx")

```


# 13. Identifying outliers for Yield and Plant Stand

####################################################################################
      
```{r}
# Ouliers for Actual Yield (Yield)
#summerizind data for median mean  and Quartiles  for Yield 

   yield_summary <- summary(cottonData$Yield)

# Estimate interquartile range
# (3rd quartile minus 1st quartile)
   iqr <- yield_summary[[5]] - yield_summary[[2]]

# Identify bounds for outliers
  lower_bound <- yield_summary[[2]] - (1.5 * iqr)
  upper_bound <- yield_summary[[5]] + (1.5 * iqr)

outliers <- cottonData %>% 
    select(Trial, State, Hybrid, Hybtype, Yield) %>% 
   filter(Yield > upper_bound |Yield < lower_bound)
   

# Remove outliers from dataframe
# Keep only the points within the bounds
# we are not removing outliers from the dataset     
     no_outliers <- cottonData %>%
     filter(Yield  < upper_bound & Yield > lower_bound)
  
# Check range of no_outliers to make sure it's within bounds
  rangeouliers <- range(no_outliers$Yield)
       
#Outputing  the outliers
     yield_summary
     iqr
     lower_bound
     upper_bound 
     outliers 
     dim(outliers )

 
# Ouliers for Actual Plant Density


#summerizind data for median mean  and Quartiles  for Yield 

   plantdensity_summary <- summary(cottonData$Plantsacre)

# Estimate interquartile range
# (3rd quartile minus 1st quartile)

   iqr_ps <-  plantdensity_summary[[5]] -  plantdensity_summary[[2]]

# Identify bounds for outliers

  lower_bound_ps <-  plantdensity_summary[[2]] - (1.5 * iqr)
  upper_bound_ps <-  plantdensity_summary[[5]] + (1.5 * iqr)

outliers_ps <- cottonData %>% 
    select(Trial, State, Hybrid, Hybtype, Plantsacre) %>% 
    filter(Plantsacre > upper_bound_ps |Plantsacre < lower_bound_ps)
   

# Remove outliers from dataframe
# Keep only the points within the bounds
# we are not removing outliers from the dataset  

     no_outliers <- cottonData %>%
     filter(Plantsacre  < upper_bound_ps & Plantsacre > lower_bound_ps)
  
# Check range of no_outliers to make sure it's within bounds

  rangeouliers <- range(no_outliers$Plantsacre)
       
#Outputing  the outliers
     plantdensity_summary
     iqr_ps
     lower_bound_ps
     upper_bound_ps 
     outliers_ps 
     dim( outliers_ps )
     
write_xlsx(list(outliers_yield = outliers,
                outliers_yield_ps =outliers_ps) ,
           "D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/General/G7_Outliers.xlsx")

```     
 
# 14. Overall Hybrid Means for  Yield and Yield Component Characters 

################################################################################

```{r}
Ovetall_Trait_Summary <- cottonData_final%>% 
  group_by(Hybrid) %>% 
  summarise( Trials  = n(),
             "Height"              = round(mean(Height),2),
             "Monopodials"         = round(mean(Monopodia),2),
             "Sympodials"          = round(mean(Sympodia),2),
             "BollNumber"         = round(mean(Bollnumber),2),
             "Bollweight_Pick1"  = round(mean(Bollweight_pick1),2),
             "Bollweight_Pick2"   = round(mean(Bollweight_pick2),2),
             "Bollweight_Pick3"   = round(mean(Bollweight_pick3),2),
             "Bollweight"         = round(mean(Bollweight),2),
             "EarlyYield"         = round(mean(Earlyyield),2),
             "Yield"               = round(mean(Yield),2),
             "Predicted Yield "    = round(mean(Predicted_Yield),2), .groups = "drop") 
#Computing  overall Trait means 
write_xlsx(list(BH_Trait_Summary = Ovetall_Trait_Summary),
           "D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/General/G9_Trait_Summary.xlsx")

```

15.Adaptability Graph : Grouping Hybrids  for adaptability based on Mean and  CV

######################################################################################

```{r}
#Outputting Means  and Coefficient variation for New products and  Checks 
stats <- cottonData_final%>% 
  group_by(Hybrid) %>% 
  summarise( Trials  = n(),
             MeanYield    = round(mean(Yield),0),
             CV = round(cv(Yield),2), .groups = "drop" ) 
             

# Mean Yield and  Mean CV  of  all the hybrids 
stat_Means <- stats %>%  
  summarise_at(c("CV", "MeanYield"), mean, na.rm = TRUE)

 

#Customizing Text values; Group1, Group2, Group3 and Group4 
grob1 <- grobTree(textGrob("Group I", x = 0.1,  y = 0.95, 
                           hjust = 0,
                           gp = gpar(col= "red", fontsize = 11, 
                                     fontface = "italic")))

grob2 <- grobTree(textGrob("Group II", x = 0.85,  y = 0.95, 
                           hjust = 0,
                           gp = gpar(col = "red", fontsize = 11, 
                                     fontface = "italic")))

grob3 <- grobTree(textGrob("Group III", x = 0.1,  y = 0.05, 
                           hjust = 0,
                           gp = gpar(col = "red", fontsize = 11, 
                                     fontface = "italic")))

grob4 <- grobTree(textGrob("Group IV", x = 0.85,  y = 0.05, 
                           hjust = 0,
                           gp = gpar(col = "red", fontsize = 11, 
                                     fontface = "italic")))

#Setting Hybrids as row names

rownames(stats) <- NULL
rownames(stats) <- stats$Hybrid

#Creating Plot 
Mean_cv_plot <- ggplot(data = stats, aes(x = CV, y = MeanYield)) +
  geom_point() +
  geom_vline(xintercept = mean(stats$CV)) +
  geom_hline(yintercept = mean(stats$MeanYield)) +
  geom_text_repel(label = rownames(stats), 
                  size = 5) +
  scale_x_continuous(limits = c(min(stats$CV), max(stats$CV)), 
                     breaks = seq(min(stats$CV),max(stats$CV), by = 4.0)) +
  scale_y_continuous(limits = c(min(stats$MeanYield), max(stats$MeanYield)), 
                     breaks = seq(min(stats$MeanYield), max(stats$MeanYield), by = 75)) +
  labs(x = "Coefficient of Variation",
       y = "Mean Yield",
       color = "Gear",
       title = "Grouping Hybrids Based on Mean and CV",
       caption = "Rallis Limited") +
  annotation_custom(grob1) +
  annotation_custom(grob2) +
  annotation_custom(grob3) +
  annotation_custom(grob4) +
  theme_bw()+
  theme( plot.background = element_rect(fill = "#BFD5E3"),
         plot.title = element_text(size = 16, 
                                   hjust = 0.50, color = "red", face = "bold"),
         axis.title.x = element_text(color = "black",
                                     size = 14, vjust = -0.35, face = "bold"),
         axis.title.y = element_text(color = "black",
                                     size = 14, vjust = 0.35, face = "bold"))

tt1 <- ttheme_default(base_size = 8)
Mean_cv_plot2 <- grid.arrange(tableGrob(stats[1:14,], theme = tt1 ),
                             Mean_cv_plot,
                             ncol = 2,
                               widths = c(0.50, 1))

fig_vg <- dml(ggobj =    Mean_cv_plot )                               


t <- "D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/General/adaptgraph.pptx"


read_pptx() %>% 
  add_slide(layout = "Title Only", master = "Office Theme") %>% 
  ph_with( fig_vg, location = ph_location(left = .5, top = 1.3, height = 5, width = 8))%>%     print(t)


```



# 16.Box Plot Exhibiting Yield Distribution of Hybrids 

   1. Boxplots shows distribution pattern and the differences in yield new Hybrids and       checks. 
   2. Box edges represent the upper and lower quantile with median value shown as bold       line and mean shown as dot in the middle of the box. 
   3. Whiskers represent 1.5 times the quantile of the data Individuals falling 
      outside the range of the whiskers shown as open dots
#####################################################################################$

```{r}
# Get Box plot Summary Statistics 

library(tidyr)
box_summary <- cottonData_final%>%
  group_by(Hybrid) %>%
  summarise(Trials = n(),
            temp = list(c(summary(object = Yield))), .groups ="drop") %>%
  unnest_wider(temp) %>% 
  mutate_if(is.numeric,funs(round(.,0)))


 #Box Plots for Each Environment

w_box <- ggplot(cottonData, 
                 aes(x = Hybrid, 
                     y = Yield, 
                     fill = Hybrid)) + 
  geom_boxplot(outlier.colour = "black", 
               outlier.shape = 16, 
               outlier.size = 2) +
  labs(title = "Box Plot : Spread of Yield Distribution for Hybrids ", 
       x = "Hybrids", 
       y = "Yield/acre") +
  theme_test() +
  stat_summary(fun = "mean", 
               geom = "point", 
               shape = 8, 
               size = 2, 
               color = "white") +
  theme(legend.position = "bottom",
        axis.text.x=element_text(angle=45,hjust=1,size =18))

tt1 <- ttheme_default(base_size = 8)

 boxplot_2 <- grid.arrange(tableGrob(box_summary[1:14,], theme = tt1 ),
                                w_box,
                                ncol = 2,
                               widths = c(0.50, 1))

t3 <- "D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/General/boxplot.pptx"


fig_vg3 <- dml(ggobj =  w_box)

read_pptx() %>% 
  add_slide(layout = "Title Only", master = "Office Theme") %>% 
  ph_with( fig_vg3, location = ph_location(left = .5, top =0.50, height = 8, width = 8)) %>% 
  print(t3)


write_xlsx(list(stats =  stats,
                stat_Means = stat_Means,
                box_summary  = box_summary),
        "D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/General/G10_box_summary.xlsx")

```


# 17a. .Box Plot and Spread Plots  Exhibiting Yield Distribution of Hybrids 


###################################################################################### 
```{r}

t4 <- "D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/General/box_spread.pptx"

library(cowplot)

Boxplot2 <- ggplot(cottonData, aes(y = Yield, 
                                       x = Hybrid, 
                                       fill = Hybrid)) +
  geom_boxplot( alpha = 0.5) +
  labs(title = "Box Plot : Spread of Yield Distribution for Hybrids ",
       y = "Yield(kg/Acre",
       x = "Hybrids")+ 
  stat_summary(fun.y = mean, geom = "point", shape = 20,
               size = 5, color = "black", fill = "red") +
  scale_fill_manual(values = c("aquamarine","aquamarine3","chartreuse", "chartreuse3","chocolate",
                               "blue","darkgray","deepskyblue4", "goldenrod4","gray5",
                               "deeppink3", "Bisque","Papaya Whip","Light Goldenrod",
                               "Floral White", "Floral White", "Navajo White","plum4", 
                               "plum2","snow2","peachpuff","pink2","lightcyan","khaki3","khaki1","grey100"))+
  theme_minimal(base_size = 15 ) +
  theme(panel.border = element_rect(fill = NA, color = "darkred", size = 0.5, 
                                    linetype = "solid"),
        axis.title.x = element_text(color = "blue", size = 14, face = "bold"),
        axis.title.y = element_text(color = "#993333", size = 14, face = "bold"), 
        plot.title = element_text(color = "coral4", size = 11, face = "bold.italic"),
        axis.text.x = element_text(angle = 45, hjust = 1, size=14,color = "black"),
        legend.position = "none", legend.direction = "") 

distributionYield <- ggplot(  cottonData, aes(x =  Yield, y = Hybrid, fill = Hybrid)) +
  stat_density_ridges(quantile_lines = TRUE, quantiles = 2, scale = 1.2) +
  labs(title = "Ridges Plot:Density  Distribution plot  for Yield ",
       x = "Yield(kg/Acre",
       y = "Hybrids") +
  geom_text(data=cottonData%>% group_by(Hybrid) %>% 
              summarise(Yield = round(mean(Yield),1), .groups = "drop"),
            aes(label = sprintf("%3.1f", Yield)), 
            position= position_nudge(y = -0.1), colour = "red1", size = 4,  fontface="bold") +
  scale_fill_manual(values = c("aquamarine","aquamarine3","chartreuse", "chartreuse3","chocolate",
                               "blue","darkgray","deepskyblue4", "goldenrod4","gray5",
                               "deeppink3", "Bisque","Papaya Whip","Light Goldenrod",
                               "Floral White", "Floral White", "Navajo White","plum4", 
                               "plum2","snow2","peachpuff","pink2","lightcyan","khaki3","khaki1","grey100"))  +
  theme_minimal(base_size = 15 ) +
  theme(panel.border = element_rect(fill = NA, color = "red1", size = 0.5, 
                                    linetype = "solid"),
        plot.title = element_text(color = "coral4", size = 14, face = "bold.italic"),
        axis.title.x = element_text(color = "blue", size = 14, face = "bold"),
        axis.title.y = element_text(color = "#993333", size = 14, face = "bold"),
        legend.position = "none")

box_spread <- plot_grid(Boxplot2, distributionYield , nrow = 1, labels = "AUTO")    


fig_vg4 <- dml(ggobj = box_spread )

read_pptx() %>% 
  add_slide(layout = "Title Only", master = "Office Theme") %>% 
  ph_with(fig_vg4, location = ph_location(left = .5, top = 1.3, height = 6, width = 8)) %>% 
  print(t4)

fig_vg4 
```

# 17b. .Box Plot and Spread Plots  Exhibiting Yield Distribution of Hybrids 

######################################################################################

```{r}
t5 <- "D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/General/box_spread2.pptx"

library(cowplot)
Boxplot2 <- ggplot(cottonData, aes(y = Yield, 
                                       x = Hybrid, 
                                       fill = Hybrid)) +
  geom_boxplot( alpha = 0.5) +
  labs(title = "Box Plot : Spread of Yield Distribution for Hybrids ",
       y = "Yield(kg/Acre",
       x = "Hybrids")+ 
  stat_summary(fun.y = mean, geom = "point", shape = 20,
               size = 5, color = "black", fill = "red") +
  scale_fill_manual(values = c("aquamarine","aquamarine3","chartreuse", "chartreuse3","chocolate",
                               "blue","darkgray","deepskyblue4", "goldenrod4","gray5",
                               "deeppink3", "Bisque","Papaya Whip","Light Goldenrod",
                               "Floral White", "Floral White", "Navajo White","plum4", 
                               "plum2","snow2","peachpuff","pink2","lightcyan","khaki3","khaki1","grey100"))+
  theme_minimal(base_size = 15 ) +
  theme(panel.border = element_rect(fill = NA, color = "darkred", size = 0.5, 
                                    linetype = "solid"),
        axis.title.x = element_text(color = "blue", size = 14, face = "bold"),
        axis.title.y = element_text(color = "#993333", size = 14, face = "bold"), 
        plot.title = element_text(color = "coral4", size = 16, face = "bold.italic"),
        axis.text.x = element_text(angle = 45, hjust = 1, size=14,color = "black"),
        legend.position = "none", legend.direction = "") 

distributionYield <- ggplot(  cottonData, aes(x =  Yield, y = Hybrid, fill = Hybrid)) +
  stat_density_ridges(quantile_lines = TRUE, quantiles = 2, scale = 1.2) +
  labs(title = "Ridges Plot:Density  Distribution plot  for Yield ",
       x = "Yield(kg/Acre",
       y = "Hybrids") +
  geom_text(data=cottonData%>% group_by(Hybrid) %>% 
              summarise(Yield = round(mean(Yield),1), .groups = "drop"),
            aes(label = sprintf("%3.1f", Yield)), 
            position= position_nudge(y = -0.1), colour = "red", size = 5) +
  scale_fill_manual(values = c("aquamarine","aquamarine3","chartreuse", "chartreuse3","chocolate",
                               "blue","darkgray","deepskyblue4", "goldenrod4","gray5",
                               "deeppink3", "Bisque","Papaya Whip","Light Goldenrod",
                               "Floral White", "Floral White", "Navajo White","plum4", 
                               "plum2","snow2","peachpuff","pink2","lightcyan","khaki3","khaki1","grey100"))  +
  theme_minimal(base_size = 15 ) +
  theme(panel.border = element_rect(fill = NA, color = "darkred", size = 0.5, 
                                    linetype = "solid"),
        plot.title = element_text(color = "coral4", size = 14, face = "bold.italic"),
        axis.title.x = element_text(color = "blue", size = 14, face = "bold"),
        axis.title.y = element_text(color = "#993333", size = 14, face = "bold"),
        legend.position = "none")

box_spread2 <- plot_grid( Boxplot2, distributionYield , nrow = 2, labels = "AUTO")    


fig_vg5 <- dml(ggobj = box_spread2 )

read_pptx() %>% 
  add_slide(layout = "Title Only", master = "Office Theme") %>% 
  ph_with(fig_vg5, location = ph_location(left = .5, top = 1.3, height = 6, width = 8)) %>% 
  print(t4)
```

# 18. Head to Head Analysis new Hybrid Versus Checks: Create Datasets 

    Hybtype	Hybrid	Total
    NH	      HC20103	 85
    	      HC20105	 85
    	      HC20107	 85
    IC	      Aatish	 42
    	      Ajooba	 11
    	      MC5401	  7
    	      Pinaka	 25
    	      Vega 	    3
    CC	    ATM	      3
    	      Jadoo	   32
    	      Jangee	 29
    	      Moksha	 31
    	      MoneyMaker 	11
    	      RCH659	 56
    	      RCHNeo	 8




## 18a. Creation of Datasets for Head to Head Comparison 

######################################################################################

```{r}
#select Varibales  for Head to Head analysis HC20105_Aatish

HC20105_Aatish <- cottonData%>%
  filter(Hybrid %in% c("HC20105","Aatish")) %>% 
  group_by(Trial) %>%
  mutate(Number = n()) %>% 
  filter(Number > 1) %>% 
  mutate(Hybrid_group = "HC20105_Aatish", 
         Check_group = "Aatish", 
         Difference = (Yield - lag(Yield, 
                                           default = Yield[-1])), 
         Win = (ifelse(Hybtype == "NH" & Difference >= 0,
                       1, NA)),
         Yield_sup = Difference*100/(lag(Yield, 
                                         default = Yield[-1])),
         Yield_sup = ifelse(Hybtype %in% c("DC","CC","IC"), NA,Yield_sup)) 


#select Varibales  for Head to Head analysis HC20105_Ajooba

HC20105_Ajooba <- cottonData%>%
  filter(Hybrid %in% c("HC20105","Ajooba")) %>% 
  group_by(Trial) %>%
  mutate(Number = n()) %>% 
  filter(Number > 1) %>% 
  mutate(Hybrid_group = "HC20105_Ajooba", 
         Check_group = "Ajooba", 
         Difference = (Yield - lag(Yield, 
                                           default = Yield[-1])), 
         Win = (ifelse(Hybtype == "NH" & Difference >= 0,
                       1, NA)),
         Yield_sup = Difference*100/(lag(Yield, 
                                         default = Yield[-1])),
         Yield_sup = ifelse(Hybtype %in% c("DC","CC","IC"), NA,Yield_sup)) 


#select Varibales  for Head to Head analysis HC20105_MC5401

HC20105_MC5401 <- cottonData%>%
  filter(Hybrid %in% c("HC20105","MC5401")) %>% 
  group_by(Trial) %>%
  mutate(Number = n()) %>% 
  filter(Number > 1) %>% 
  mutate(Hybrid_group = "HC20105_MC5401", 
         Check_group = "MC5401", 
         Difference = (Yield - lag(Yield, 
                                           default = Yield[-1])), 
         Win = (ifelse(Hybtype == "NH" & Difference >= 0,
                       1, NA)),
         Yield_sup = Difference*100/(lag(Yield, 
                                         default = Yield[-1])),
         Yield_sup = ifelse(Hybtype %in% c("DC","CC","IC"), NA,Yield_sup)) 



#select Varibales  for Head to Head analysis HC20105_Pinaka

HC20105_Pinaka <- cottonData%>%
  filter(Hybrid %in% c("HC20105","Pinaka")) %>% 
  group_by(Trial) %>%
  mutate(Number = n()) %>% 
  filter(Number > 1) %>% 
  mutate(Hybrid_group = "HC20105_Pinaka", 
         Check_group = "Pinaka", 
         Difference = (Yield - lag(Yield, 
                                           default = Yield[-1])), 
         Win = (ifelse(Hybtype == "NH" & Difference >= 0,
                       1, NA)),
         Yield_sup = Difference*100/(lag(Yield, 
                                         default = Yield[-1])),
         Yield_sup = ifelse(Hybtype %in% c("DC","CC","IC"), NA,Yield_sup)) 



#select Varibales  for Head to Head analysis HC20105_Vega

HC20105_Vega <- cottonData%>%
  filter(Hybrid %in% c("HC20105","Vega")) %>% 
  group_by(Trial) %>%
  mutate(Number = n()) %>% 
  filter(Number > 1) %>% 
  mutate(Hybrid_group = "HC20105_Vega", 
         Check_group = "Vega", 
         Difference = (Yield - lag(Yield, 
                                           default = Yield[-1])), 
         Win = (ifelse(Hybtype == "NH" & Difference >= 0,
                       1, NA)),
         Yield_sup = Difference*100/(lag(Yield, 
                                         default = Yield[-1])),
         Yield_sup = ifelse(Hybtype %in% c("DC","CC","IC"), NA,Yield_sup)) 


#select Varibales  for Head to Head analysis HC20105_RCH659

HC20105_RCH659 <- cottonData%>%
  filter(Hybrid %in% c("HC20105","RCH659")) %>% 
  group_by(Trial) %>%
  mutate(Number = n()) %>% 
  filter(Number > 1) %>% 
  mutate(Hybrid_group = "HC20105_RCH659", 
         Check_group = "RCH659", 
         Difference = (Yield - lag(Yield, 
                                           default = Yield[-1])), 
         Win = (ifelse(Hybtype == "NH" & Difference >= 0,
                       1, NA)),
         Yield_sup = Difference*100/(lag(Yield, 
                                         default = Yield[-1])),
         Yield_sup = ifelse(Hybtype %in% c("DC","CC","IC"), NA,Yield_sup)) 




#select Varibales  for Head to Head analysis HC20105_Jadoo

HC20105_Jadoo <- cottonData%>%
  filter(Hybrid %in% c("HC20105","Jadoo")) %>% 
  group_by(Trial) %>%
  mutate(Number = n()) %>% 
  filter(Number > 1) %>% 
  mutate(Hybrid_group = "HC20105_Jadoo", 
         Check_group = "Jadoo", 
         Difference = (Yield - lag(Yield, 
                                           default = Yield[-1])), 
         Win = (ifelse(Hybtype == "NH" & Difference >= 0,
                       1, NA)),
         Yield_sup = Difference*100/(lag(Yield, 
                                         default = Yield[-1])),
         Yield_sup = ifelse(Hybtype %in% c("DC","CC","IC"), NA,Yield_sup)) 


#select Varibales  for Head to Head analysis HC20105_Moksha

HC20105_Moksha <- cottonData%>%
  filter(Hybrid %in% c("HC20105","Moksha")) %>% 
  group_by(Trial) %>%
  mutate(Number = n()) %>% 
  filter(Number > 1) %>% 
  mutate(Hybrid_group = "HC20105_Moksha", 
         Check_group = "Moksha", 
         Difference = (Yield - lag(Yield, 
                                           default = Yield[-1])), 
         Win = (ifelse(Hybtype == "NH" & Difference >= 0,
                       1, NA)),
         Yield_sup = Difference*100/(lag(Yield, 
                                         default = Yield[-1])),
         Yield_sup = ifelse(Hybtype %in% c("DC","CC","IC"), NA,Yield_sup)) 


#select Varibales  for Head to Head analysis HC20105_Jangee

HC20105_Jangee <- cottonData%>%
  filter(Hybrid %in% c("HC20105","Jangee")) %>% 
  group_by(Trial) %>%
  mutate(Number = n()) %>% 
  filter(Number > 1) %>% 
  mutate(Hybrid_group = "HC20105_Jangee", 
         Check_group = "Jangee", 
         Difference = (Yield - lag(Yield, 
                                           default = Yield[-1])), 
         Win = (ifelse(Hybtype == "NH" & Difference >= 0,
                       1, NA)),
         Yield_sup = Difference*100/(lag(Yield, 
                                         default = Yield[-1])),
         Yield_sup = ifelse(Hybtype %in% c("DC","CC","IC"), NA,Yield_sup))
         
         
#select Varibales  for Head to Head analysis HC20105_MoneyMaker

HC20105_MoneyMaker <- cottonData%>%
  filter(Hybrid %in% c("HC20105","MoneyMaker")) %>% 
  group_by(Trial) %>%
  mutate(Number = n()) %>% 
  filter(Number > 1) %>% 
  mutate(Hybrid_group = "HC20105_MoneyMaker", 
         Check_group = "MoneyMaker", 
         Difference = (Yield - lag(Yield, 
                                           default = Yield[-1])), 
         Win = (ifelse(Hybtype == "NH" & Difference >= 0,
                       1, NA)),
         Yield_sup = Difference*100/(lag(Yield, 
                                         default = Yield[-1])),
         Yield_sup = ifelse(Hybtype %in% c("DC","CC","IC"), NA,Yield_sup))         
         
         
         
#select Varibales  for Head to Head analysis HC20105_ATM

HC20105_ATM <- cottonData%>%
  filter(Hybrid %in% c("HC20105","ATM")) %>% 
  group_by(Trial) %>%
  mutate(Number = n()) %>% 
  filter(Number > 1) %>% 
  mutate(Hybrid_group = "HC20105_ATM", 
         Check_group = "ATM", 
         Difference = (Yield - lag(Yield, 
                                           default = Yield[-1])), 
         Win = (ifelse(Hybtype == "NH" & Difference >= 0,
                       1, NA)),
         Yield_sup = Difference*100/(lag(Yield, 
                                         default = Yield[-1])),
         Yield_sup = ifelse(Hybtype %in% c("DC","CC","IC"), NA,Yield_sup))         
         
         
         
#select Varibales  for Head to Head analysis HC20105_RCHNeo

HC20105_RCHNeo <- cottonData%>%
  filter(Hybrid %in% c("HC20105","RCHNeo")) %>% 
  group_by(Trial) %>%
  mutate(Number = n()) %>% 
  filter(Number > 1) %>% 
  mutate(Hybrid_group = "HC20105_RCHNeo", 
         Check_group = "RCHNeo", 
         Difference = (Yield - lag(Yield, 
                                           default = Yield[-1])), 
         Win = (ifelse(Hybtype == "NH" & Difference >= 0,
                       1, NA)),
         Yield_sup = Difference*100/(lag(Yield, 
                                         default = Yield[-1])),
         Yield_sup = ifelse(Hybtype %in% c("DC","CC","IC"), NA,Yield_sup))          
         
```         


# 18b. Combining All datasets of Head to Head  comparison
######################################################################################

```{r}
All_combined <- bind_rows(HC20105_Aatish,
                          HC20105_Ajooba,
                          HC20105_Pinaka,
                          HC20105_MC5401,
                          HC20105_Vega,
                          HC20105_RCH659,
                          HC20105_Jadoo,
                          HC20105_Moksha,
                          HC20105_Jangee,
                          HC20105_MoneyMaker,
                          HC20105_RCHNeo,
                          HC20105_ATM) %>% 
  mutate(Type_Hybrid  = ifelse(Hybtype %in% c("IC", "CC"), 
                               "CC", Hybtype)) %>% 
  select(-Hybtype)

```



# 18b. Computing  Mean Yield,Wins, Wins% and Superiority of New Hybrids and Checks 

######################################################################################

```{r}
#Hybrids Vs checks-Means and Wins across allLocations for yield and Yield components

HybridMeans <- All_combined %>% 
  group_by(Hybrid_group,Type_Hybrid,Hybrid) %>% 
  summarise( Trials  = n(),
             "Height"              = round(mean(Height),2),
             "Monopodials"         = round(mean(Monopodia),2),
             "Sympodials"          = round(mean(Sympodia),2),
             "BollNumber"         = round(mean(Bollnumber),2),
             "Bollweight_Pick1"  = round(mean(Bollweight_pick1),2),
             "Bollweight_Pick2"   = round(mean(Bollweight_pick2),2),
             "Bollweight_Pick3"   = round(mean(Bollweight_pick3),2),
             "Bollweight"         = round(mean(Bollweight),2),
             "EarlyYield"         = round(mean(Earlyyield),2),
             "Yield"               = round(mean(Yield),2),
             "Yield_Superiority"   = round(mean(Yield_sup),2),
             "Wins"     = sum(Win, na.rm = T), .groups = "drop" ) %>%
          mutate( State = "All States",
           Wins_PCT = Wins/Trials * 100) %>%
  mutate_at(vars(Wins_PCT),round,2) %>% 
  arrange(Hybrid_group,desc(Type_Hybrid),Hybrid) 


#Hybrids Vs checks- State-Wise Means and Wins across for yield and Yield components



StateHybridMeans  <- All_combined %>% 
  group_by(Hybrid_group, State,Type_Hybrid,Hybrid) %>%  
  summarise( Trials  = n(),
             "Height"              = round(mean(Height),2),
             "Monopodials"         = round(mean(Monopodia),2),
             "Sympodials"          = round(mean(Sympodia),2),
             "BollNumber"         = round(mean(Bollnumber),2),
             "Bollweight_Pick1"  = round(mean(Bollweight_pick1),2),
             "Bollweight_Pick2"   = round(mean(Bollweight_pick2),2),
             "Bollweight_Pick3"   = round(mean(Bollweight_pick3),2),
             "Bollweight"         = round(mean(Bollweight),2),
             "EarlyYield"         = round(mean(Earlyyield),2),
             "Yield"               = round(mean(Yield),2),
             "Yield_Superiority"   = round(mean(Yield_sup),2),
             "Wins"     = sum(Win, na.rm = T), .groups = "drop" ) %>%
  mutate(Wins_PCT = Wins/Trials * 100) %>%
  mutate_at(vars(Wins_PCT),round,2) %>% 
  arrange(Hybrid_group,desc(Type_Hybrid),Hybrid) 


#Hybrids Vs checks-Means  for Scored traitsacross all the Locations 

HybridMeans_score_traits <- All_combined %>% 
  group_by(Hybrid_group,Type_Hybrid ,Hybrid) %>% 
  summarise( Trials  = n(),
           "Standability"  = round(mean(Standability,na.rm = T),2),
           "Pickabilty" =  round(mean(Pickabilty,na.rm = T),2),
           "Suckingpest_60days" = round(mean(Suckingpest_60days, na.rm = T),2),
             "Suckingpest-120days" = round(mean(Suckingpest_120days, na.rm = T),2),
             "Bollworm"   = round(mean(Bollworm,na.rm = T),2),
             "Leafcurl"   = round(mean(Leafcurl,na.rm = T),2),
             "Wiltscore" = round(mean(Wiltscore,na.rm = T),2),.groups="drop")



allState_Hybrid_comb = bind_rows( HybridMeans,
                                  StateHybridMeans) %>% 
  arrange(Hybrid_group,State,desc(Type_Hybrid)) %>% 
  select(Hybrid_group, State, Type_Hybrid, Hybrid, Trials, everything())

allState_Hybrid_comb_final <- allState_Hybrid_comb %>% 
   select(Hybrid_group,State,Type_Hybrid, Hybrid, Trials, Height, Monopodials, 
          Sympodials, BollNumber, Bollweight_Pick1, Bollweight_Pick2, 
          Bollweight_Pick3,Bollweight, EarlyYield, Yield, 
          Yield_Superiority,Wins,Wins_PCT)


Hybrid_means_yield <- HybridMeans %>% 
  select(Hybrid_group,Hybrid, Yield, Trials, Wins, Wins_PCT)

allState_Hybrid_yield <- allState_Hybrid_comb %>% 
  select(Hybrid_group,State,Hybrid,Type_Hybrid, Yield, Trials, Wins, Wins_PCT)%>% 
  arrange(Hybrid_group,State,desc(Type_Hybrid)) 
  

write_xlsx(list(All_data = All_combined,
                HybridMeans = HybridMeans,
                StateHybridMeans = StateHybridMeans,
                allState_Hybrid_comb = allState_Hybrid_comb,
                allState_Hybrid_comb_final = allState_Hybrid_comb_final,
                Hybrid_means_yield = Hybrid_means_yield,
                allState_Hybrid_yield = allState_Hybrid_yield,
                AllStates = allState_Hybrid_yield,
                Score_traits = HybridMeans_score_traits),
"D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/HC20105/NH1_Means_Wins_Yield_Superiority.xlsx")

```

# 18c. Computing Superiority of New Hybrids and Checks 

######################################################################################

```{r}

superority <- HybridMeans %>% 
  select(-State) %>% 
  mutate( "Hybrid Name" = paste0(Hybrid_group, Type_Hybrid)) %>% 
  remove_rownames %>% 
  column_to_rownames(var = 'Hybrid Name') %>% 
  rownames_to_column %>%  
  select(-Hybrid_group, -Type_Hybrid,-Hybrid) %>% 
  gather(variable, value, -rowname) %>% 
  spread(rowname, value) %>% 
  mutate(Aatish_Superiority	=(HC20105_AatishNH-HC20105_AatishCC)/HC20105_AatishCC*100,
      Ajooba_Superiority =(HC20105_AjoobaNH-HC20105_AjoobaCC)/HC20105_AjoobaCC*100,
      MC5401_Superiority =(HC20105_MC5401NH-HC20105_MC5401CC)/HC20105_MC5401CC*100,
      Pinaka_Superiority =(HC20105_PinakaNH-HC20105_PinakaCC)/HC20105_PinakaCC*100,
      Vega_Superiority	= (HC20105_VegaNH-HC20105_VegaCC)/HC20105_VegaCC*100,
      ATM_Superiority	= (HC20105_ATMNH-HC20105_ATMCC)/HC20105_ATMCC*100,
      Jadoo_Superiority	= (HC20105_JadooNH-HC20105_JadooCC)/HC20105_JadooCC*100,
      Jangee_Superiority =(HC20105_JangeeNH-HC20105_JangeeCC)/HC20105_JangeeCC*100,
      Moksha_Superiority =(HC20105_MokshaNH-HC20105_MokshaCC)/HC20105_MokshaCC*100,
    MoneyMaker_Superiority = 
    (HC20105_MoneyMakerNH-HC20105_MoneyMakerCC)/HC20105_MoneyMakerCC*100,
    RCH659_Superiority =(HC20105_RCH659NH-HC20105_RCH659CC)/HC20105_RCH659CC*100,
    RCHNeo_Superiority	=(HC20105_RCHNeoNH-HC20105_RCHNeoCC)/HC20105_RCHNeoCC*100) %>%   mutate(across(is.numeric, ~ round(., 2))) %>% 
  mutate_all(funs(replace(., .== "Inf", NA))) %>%   
  mutate_all(funs(replace(., .== 0.00, NA))) %>%  
            rename("Attribute" = variable) %>% 
      select(Attribute, 
              HC20105_AatishNH, HC20105_AatishCC, Aatish_Superiority,
              HC20105_AjoobaNH, HC20105_AjoobaCC, Ajooba_Superiority,
              HC20105_PinakaNH, HC20105_PinakaCC, Pinaka_Superiority,
              HC20105_MC5401NH, HC20105_MC5401CC, MC5401_Superiority,
              HC20105_VegaNH,     HC20105_VegaCC,  Vega_Superiority, 
              HC20105_RCH659NH, HC20105_RCH659CC, RCH659_Superiority,
              HC20105_JadooNH,  HC20105_JadooCC, Jadoo_Superiority,
              HC20105_JangeeNH, HC20105_JangeeCC, Jangee_Superiority,
              HC20105_MokshaNH, HC20105_MokshaCC,Moksha_Superiority,
              HC20105_MoneyMakerNH, HC20105_MoneyMakerCC,MoneyMaker_Superiority,
              HC20105_ATMNH, HC20105_ATMCC,ATM_Superiority,
              HC20105_RCHNeoNH, HC20105_RCHNeoCC,RCHNeo_Superiority,
              everything()) %>% 
slice(7,8,9, 1,3,4,5,2,6,13,10,11,12)



#Outputing all the  results

 
superority


write_xlsx(list(Superority  = superority),
"D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/HC20105/NH2_Superiority.xlsx")

```


# 19. Creating Summary table of State-wise Trials, Mean Yields and Wins                                                   #
#######################################################################################

```{r}
HC20105_all_Hybrid <- All_combined %>% 
    ungroup() %>% 
    select(Hybrid_group, Hybrid, Type_Hybrid, Yield, Win) %>% 
    group_by(Hybrid_group,Type_Hybrid,Hybrid,) %>% 
    summarise( Trials  = n(),
               "Yield"    = round(mean(Yield),2),
               Wins     = sum(Win,na.rm = TRUE),.groups ="drop" ) %>% 
    gather(variable, value,-Hybrid_group,-Hybrid,-Type_Hybrid) %>%
    filter(!is.na(value)) %>% 
    group_by(Hybrid_group, Hybrid) %>% 
    unite(temp, Hybrid, variable) %>% 
    mutate(id = row_number()) %>% 
    filter(id %in% c(1,3,4,6)) %>% 
    mutate(seq=paste0(Hybrid_group,id)) %>% 
    ungroup(Hybrid_group) %>% 
    select(-Hybrid_group, -id, -temp, -Type_Hybrid) %>% 
    spread(seq,value) %>% 
    mutate(State = "All States") %>% 
    select(State, everything())


#Summarize State Wise


HC20105_all_State <- All_combined %>% 
    ungroup() %>% 
    select(State,Hybrid_group, Hybrid,Type_Hybrid, Yield, Win) %>% 
    group_by(State,Hybrid_group,Type_Hybrid,Hybrid) %>% 
    summarise( Trials  = n(),
               "Yield"    = round(mean(Yield),2),
               Wins     = sum(Win,na.rm = TRUE),.groups ="drop" ) %>% 
    gather(variable, value,
           -c(Hybrid_group,Hybrid,State,Type_Hybrid))  %>%
    filter(!is.na(value)) %>% 
    group_by(State,Hybrid_group, Hybrid) %>% 
    unite(temp, Hybrid, variable) %>% 
    mutate(id = row_number()) %>% 
    filter(id %in% c(1,3,4,6)) %>% 
    mutate(seq=paste0(Hybrid_group,id)) %>% 
    ungroup(Hybrid_group) %>% 
    select(-Hybrid_group, -id, -temp, -Type_Hybrid) %>% 
    spread(seq,value) 



# Combine HC20105_all_State  and HC20105_all_Hybrid by rows

HC20105_State_Trials_Wins <- bind_rows(HC20105_all_State,
                                       HC20105_all_Hybrid)


write_xlsx(list(HC20105_All = HC20105_State_Trials_Wins),
           "D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/HC20105/NH3_State_Trials_Means_Wins_B.xlsx")

######################################################################################

```




# 20A. Creating Summary tables for Excel Dash boards for HC20105
    1. New Hybrids Versus Checks: Production factors, Yield superioirty 

##############################################################################################


```{r}

HC20105_data <- All_combined %>% 
    select(Trial, State, Loc, Cropmanagmt,Sowingdate,Cultivation, Hybrid, Check_group, Yield) %>% 
      filter(Hybrid == "HC20105")
HC20105_checks <- All_combined %>% 
    filter(Hybrid != "HC20105") %>% 
    select(Trial, State, Yield)  

HC20105_checks_df <- cbind(HC20105_data,
                               HC20105_checks) %>% 
    select(-Trial...10, -State...11) %>% 
    rename(Trial = Trial...1,
           State = State...2,
           NH_Yield = Yield...9,
           CC_Yield = Yield...12)
           
    
##############################################################################################

#Create  Datasets  for HEad to Head comparison of HC20105 with all Checks 


HC20105_Aatish_df <- HC20105_checks_df %>% 
  filter(Check_group == "Aatish") %>% 
  select(-Hybrid,-Check_group) %>% 
  mutate(Superiority = (NH_Yield  - CC_Yield)*100/CC_Yield) %>% 
  mutate_each(funs(round(., 0)),NH_Yield ,CC_Yield) %>% 
  mutate_each(funs(round(., 2)), Superiority) %>%
  rename(HC20105 = NH_Yield,
         Aatish = CC_Yield)



HC20105_Ajooba_df <- HC20105_checks_df %>% 
  filter(Check_group == "Ajooba") %>% 
  select(-Hybrid,-Check_group) %>% 
  mutate(Superiority = (NH_Yield  - CC_Yield)*100/CC_Yield) %>% 
  mutate_each(funs(round(., 0)),NH_Yield ,CC_Yield) %>% 
  mutate_each(funs(round(., 2)), Superiority) %>%
  rename(HC20105 = NH_Yield,
         Ajooba = CC_Yield)
         
         
HC20105_Pinaka_df <- HC20105_checks_df %>% 
  filter(Check_group == "Pinaka") %>% 
  select(-Hybrid,-Check_group) %>% 
  mutate(Superiority = (NH_Yield  - CC_Yield)*100/CC_Yield) %>% 
  mutate_each(funs(round(., 0)),NH_Yield ,CC_Yield) %>% 
  mutate_each(funs(round(., 2)), Superiority) %>%
  rename(HC20105 = NH_Yield,
         Pinaka = CC_Yield)
         

HC20105_MC5401_df <- HC20105_checks_df %>% 
  filter(Check_group == "MC5401") %>% 
  select(-Hybrid,-Check_group) %>% 
  mutate(Superiority = (NH_Yield  - CC_Yield)*100/CC_Yield) %>% 
  mutate_each(funs(round(., 0)),NH_Yield ,CC_Yield) %>% 
  mutate_each(funs(round(., 2)), Superiority) %>%
  rename(HC20105 = NH_Yield,
         MC5401 = CC_Yield)


HC20105_Vega_df <- HC20105_checks_df %>% 
  filter(Check_group == "Vega") %>% 
  select(-Hybrid,-Check_group) %>% 
  mutate(Superiority = (NH_Yield  - CC_Yield)*100/CC_Yield) %>% 
  mutate_each(funs(round(., 0)),NH_Yield ,CC_Yield) %>% 
  mutate_each(funs(round(., 2)), Superiority) %>%
  rename(HC20105 = NH_Yield,
         Vega = CC_Yield)

HC20105_RCH659_df <- HC20105_checks_df %>% 
  filter(Check_group == "RCH659") %>% 
  select(-Hybrid,-Check_group) %>% 
  mutate(Superiority = (NH_Yield  - CC_Yield)*100/CC_Yield) %>% 
  mutate_each(funs(round(., 0)),NH_Yield ,CC_Yield) %>% 
  mutate_each(funs(round(., 2)), Superiority) %>%
  rename(HC20105 = NH_Yield,
         RCH659 = CC_Yield)

HC20105_RCHNeo_df <- HC20105_checks_df %>% 
  filter(Check_group == "RCHNeo") %>% 
  select(-Hybrid,-Check_group) %>% 
  mutate(Superiority = (NH_Yield  - CC_Yield)*100/CC_Yield) %>% 
  mutate_each(funs(round(., 0)),NH_Yield ,CC_Yield) %>% 
  mutate_each(funs(round(., 2)), Superiority) %>%
  rename(HC20105 = NH_Yield,
         RCHNeo = CC_Yield)

HC20105_Jadoo_df <- HC20105_checks_df %>% 
  filter(Check_group == "Jadoo") %>% 
  select(-Hybrid,-Check_group) %>% 
  mutate(Superiority = (NH_Yield  - CC_Yield)*100/CC_Yield) %>% 
  mutate_each(funs(round(., 0)),NH_Yield ,CC_Yield) %>% 
  mutate_each(funs(round(., 2)), Superiority) %>%
  rename(HC20105 = NH_Yield,
         Jadoo = CC_Yield)


HC20105_Moksha_df <- HC20105_checks_df %>% 
  filter(Check_group == "Moksha") %>% 
  select(-Hybrid,-Check_group) %>% 
  mutate(Superiority = (NH_Yield  - CC_Yield)*100/CC_Yield) %>% 
  mutate_each(funs(round(., 0)),NH_Yield ,CC_Yield) %>% 
  mutate_each(funs(round(., 2)), Superiority) %>%
  rename(HC20105 = NH_Yield,
         Moksha = CC_Yield)

HC20105_Jangee_df <- HC20105_checks_df %>% 
  filter(Check_group == "Jangee") %>% 
  select(-Hybrid,-Check_group) %>% 
  mutate(Superiority = (NH_Yield  - CC_Yield)*100/CC_Yield) %>% 
  mutate_each(funs(round(., 0)),NH_Yield ,CC_Yield) %>% 
  mutate_each(funs(round(., 2)), Superiority) %>%
  rename(HC20105 = NH_Yield,
         Jangee = CC_Yield)


HC20105_MoneyMaker_df <- HC20105_checks_df %>% 
  filter(Check_group == "MoneyMaker") %>% 
  select(-Hybrid,-Check_group) %>% 
  mutate(Superiority = (NH_Yield  - CC_Yield)*100/CC_Yield) %>% 
  mutate_each(funs(round(., 0)),NH_Yield ,CC_Yield) %>% 
  mutate_each(funs(round(., 2)), Superiority) %>%
  rename(HC20105 = NH_Yield,
         MoneyMaker = CC_Yield)


HC20105_ATM_df <- HC20105_checks_df %>% 
  filter(Check_group == "ATM") %>% 
  select(-Hybrid,-Check_group) %>% 
  mutate(Superiority = (NH_Yield  - CC_Yield)*100/CC_Yield) %>% 
  mutate_each(funs(round(., 0)),NH_Yield ,CC_Yield) %>% 
  mutate_each(funs(round(., 2)), Superiority) %>%
  rename(HC20105 = NH_Yield,
         ATM = CC_Yield)


# 20B. Create wb  and  workbooks

##############################################################################################


# A. Workbook for checkwise superority     

  wb <- createWorkbook()
    
    addWorksheet(wb, "HC20105_sup")
    
    writeData(wb, "HC20105_sup", HC20105_Aatish_df, 
              startRow = 1, startCol = 1)
    
     writeData(wb, "HC20105_sup", HC20105_Ajooba_df, 
              startRow = 47, startCol = 1)
     
    writeData(wb, "HC20105_sup", HC20105_Pinaka_df, 
              startRow = 63, startCol = 1)     
    
    writeData(wb, "HC20105_sup", HC20105_MC5401_df, 
              startRow = 92, startCol = 1)
    
    writeData(wb, "HC20105_sup", HC20105_Vega_df, 
              startRow = 104, startCol = 1)
     
    writeData(wb, "HC20105_sup", HC20105_RCH659_df, 
              startRow = 112, startCol = 1)
 
    writeData(wb, "HC20105_sup", HC20105_RCHNeo_df, 
              startRow = 173, startCol = 1)
    
     writeData(wb, "HC20105_sup", HC20105_Jadoo_df, 
              startRow = 186, startCol = 1)
     
    writeData(wb, "HC20105_sup", HC20105_Moksha_df, 
              startRow = 223, startCol = 1)             

    writeData(wb, "HC20105_sup", HC20105_Jangee_df, 
              startRow =257, startCol = 1)
    
     writeData(wb, "HC20105_sup", HC20105_MoneyMaker_df, 
              startRow = 294, startCol = 1)
     
    writeData(wb, "HC20105_sup", HC20105_ATM_df, 
              startRow = 312, startCol = 1)
              
              
              
    saveWorkbook(wb, "D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/HC20105/NH4_State_Hybrid_Rows.xlsx")
    
```


```{r}
#B. Comining datasets datasets  for dashboard superiority rowwise 

    HC20105_Aatish_YLD <- data.frame(HC20105_Aatish_df)
    HC20105_Ajooba_YLD <- data.frame(HC20105_Ajooba_df)
    HC20105_Pinaka_YLD <- data.frame(HC20105_Pinaka_df)
    HC20105_MC5401_YLD <- data.frame(HC20105_MC5401_df)
    HC20105_Vega_YLD <- data.frame(HC20105_Vega_df)
    
    HC20105_RCH659_YLD <- data.frame(HC20105_RCH659_df)
    HC20105_RCHNeo_YLD <- data.frame(HC20105_RCHNeo_df)
    HC20105_Jadoo_YLD <- data.frame(HC20105_Jadoo_df)
    HC20105_Moksha_YLD <- data.frame(HC20105_Moksha_df)
    HC20105_Jangee_YLD <- data.frame(HC20105_Jangee_df)
    HC20105_MoneyMaker_YLD <- data.frame(HC20105_MoneyMaker_df)
    HC20105_ATM_YLD <- data.frame(HC20105_ATM_df)
  

    wb <- createWorkbook()

    addWorksheet(wb, "HC20105_sup")
    
    writeData(wb, "HC20105_sup", HC20105_Aatish_YLD, 
              startRow = 1, startCol = 1)
    
    writeData(wb, "HC20105_sup", HC20105_Ajooba_YLD, 
              startRow = 1, startCol = 14)
    
    writeData(wb, "HC20105_sup", HC20105_Pinaka_YLD, 
              startRow = 1, startCol = 28)
  
    
    writeData(wb, "HC20105_sup", HC20105_MC5401_YLD, 
              startRow = 1, startCol = 42)
    
    writeData(wb, "HC20105_sup", HC20105_Vega_YLD, 
              startRow = 1, startCol = 56)
    
    writeData(wb, "HC20105_sup", HC20105_RCH659_YLD, 
              startRow = 1, startCol = 70)
                  
    writeData(wb, "HC20105_sup", HC20105_RCHNeo_YLD, 
              startRow = 1, startCol = 84)
    
    writeData(wb, "HC20105_sup", HC20105_Jadoo_YLD, 
              startRow = 1, startCol = 98)
    
    writeData(wb, "HC20105_sup", HC20105_Moksha_YLD, 
              startRow = 1, startCol = 112)
                  
    writeData(wb, "HC20105_sup", HC20105_Jangee_YLD, 
              startRow = 1, startCol = 126)
    
    writeData(wb, "HC20105_sup", HC20105_MoneyMaker_YLD, 
              startRow = 1, startCol = 140)
    
    writeData(wb, "HC20105_sup",    HC20105_ATM_YLD , 
              startRow = 1, startCol = 154)
              

 saveWorkbook(wb, "D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/HC20105/NH5_State_Hybrid_Columns.xlsx")
       

```
 
 
 
 
 
# 21A. Genotype x Environment-Reression plots based Eberhar and Russel model HC20105 Vs Checks 
############################################################################################## 
```{r}    
#Dataset for HC20105 vs Checks 


HC20105_Yld <- cottonData%>%
      select(Trial,State,Loc,Cropmanagmt,Cultivation,Sowingdate,Hybrid, Yield)%>%
      gather(key, val, -c(Trial,Loc,Cropmanagmt,Cultivation,State,Sowingdate,Hybrid)) %>% 
      group_by(Trial, State, Loc, Hybrid) %>% 
      mutate(N = row_number()) %>% 
      dplyr::select(-key, -N) %>% 
      spread(Hybrid,val) %>% 
      rowwise() %>% 
      mutate(Locationmean_YLD = mean(c_across(Aatish:Vega), na.rm = TRUE)) %>% 
      mutate_if(is.numeric, round,0)

    write_xlsx(list(GESummary =  HC20105_Yld),
               "D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/HC20105/NH6_GESummary.xlsx")




#Separating  Check wise data  and Computing  Head  to head comparision for yield superiorority 
 
  
HC20105_Aatish_Reg <- HC20105_Yld %>% 
    select(Trial,State,Loc,Cropmanagmt,Cultivation,Sowingdate, State, Locationmean_YLD, 
    HC20105,Aatish) %>% 
    drop_na() %>% 
    mutate(Superority = (HC20105 - Aatish)/Aatish*100,
           Superority  = round(Superority,2),Check = "Aatish")   
    

  
HC20105_Ajooba_Reg <- HC20105_Yld %>% 
    select(Trial,State,Loc,Cropmanagmt,Cultivation,Sowingdate, State, Locationmean_YLD, 
    HC20105,Ajooba) %>% 
    drop_na() %>% 
    mutate(Superority = (HC20105 - Ajooba)/Ajooba*100,
           Superority  = round(Superority,2),Check = "Ajooba")   


  
HC20105_Pinaka_Reg <- HC20105_Yld %>% 
    select(Trial,State,Loc,Cropmanagmt,Cultivation,Sowingdate, State, Locationmean_YLD, 
    HC20105,Pinaka) %>% 
    drop_na() %>% 
    mutate(Superority = (HC20105 - Pinaka)/Pinaka*100,
           Superority  = round(Superority,2),Check = "Pinaka")   



  
HC20105_MC5401_Reg <- HC20105_Yld %>% 
    select(Trial,State,Loc,Cropmanagmt,Cultivation,Sowingdate, State, Locationmean_YLD, 
    HC20105,MC5401) %>% 
    drop_na() %>% 
    mutate(Superority = (HC20105 - MC5401)/MC5401*100,
           Superority  = round(Superority,2),Check = "MC5401")   


  
HC20105_Vega_Reg <- HC20105_Yld %>% 
    select(Trial,State,Loc,Cropmanagmt,Cultivation,Sowingdate, State, Locationmean_YLD, 
    HC20105,Vega) %>% 
    drop_na() %>% 
    mutate(Superority = (HC20105 - Vega)/Vega*100,
           Superority  = round(Superority,2),Check = "Vega")   


HC20105_RCH659_Reg <- HC20105_Yld %>% 
    select(Trial,State,Loc,Cropmanagmt,Cultivation,Sowingdate, State, Locationmean_YLD, 
    HC20105,RCH659) %>% 
    drop_na() %>% 
    mutate(Superority = (HC20105 - RCH659)/RCH659*100,
           Superority  = round(Superority,2),Check = "RCH659")   



  
HC20105_RCHNeo_Reg <- HC20105_Yld %>% 
    select(Trial,State,Loc,Cropmanagmt,Cultivation,Sowingdate, State, Locationmean_YLD, 
    HC20105,RCHNeo) %>% 
    drop_na() %>% 
    mutate(Superority = (HC20105 - RCHNeo)/RCHNeo*100,
           Superority  = round(Superority,2),Check = "RCHNeo")   


HC20105_Jadoo_Reg <- HC20105_Yld %>% 
    select(Trial,State,Loc,Cropmanagmt,Cultivation,Sowingdate, State, Locationmean_YLD, 
    HC20105,Jadoo) %>% 
    drop_na() %>% 
    mutate(Superority = (HC20105 - Jadoo)/Jadoo*100,
           Superority  = round(Superority,2),Check = "Jadoo")   


HC20105_Moksha_Reg <- HC20105_Yld %>% 
    select(Trial,State,Loc,Cropmanagmt,Cultivation,Sowingdate, State, Locationmean_YLD, 
    HC20105,Moksha) %>% 
    drop_na() %>% 
    mutate(Superority = (HC20105 - Moksha)/Moksha*100,
           Superority  = round(Superority,2),Check = "Moksha")   


  
HC20105_Jangee_Reg <- HC20105_Yld %>% 
    select(Trial,State,Loc,Cropmanagmt,Cultivation,Sowingdate, State, Locationmean_YLD, 
    HC20105,Jangee) %>% 
    drop_na() %>% 
    mutate(Superority = (HC20105 - Jangee)/Jangee*100,
           Superority  = round(Superority,2),Check = "Jangee")   


  
HC20105_MoneyMaker_Reg <- HC20105_Yld %>% 
    select(Trial,State,Loc,Cropmanagmt,Cultivation,Sowingdate, State, Locationmean_YLD, 
    HC20105,MoneyMaker) %>% 
    drop_na() %>% 
    mutate(Superority = (HC20105 - MoneyMaker)/MoneyMaker*100,
           Superority  = round(Superority,2),Check = "MoneyMaker")   


HC20105_ATM_Reg <- HC20105_Yld %>% 
    select(Trial,State,Loc,Cropmanagmt,Cultivation,Sowingdate, State, Locationmean_YLD, 
    HC20105,ATM) %>% 
    drop_na() %>% 
    mutate(Superority = (HC20105 - ATM)/ATM*100,
           Superority  = round(Superority,2),Check = "ATM")   
      

# Creating Required datasetsand Combining them for Construction regression plots


#Data set for Aatish

    HC20105_Aatish_CC <- HC20105_Aatish_Reg %>%
    select(-Superority, -HC20105,-Check) %>%
    mutate(CheckType = "HC20105VsAatish",
    Group     = "Check" ) %>%
    rename(EnvIndex = Locationmean_YLD,
    Yield = Aatish)
    
    HC20105_Aatish_NH <- HC20105_Aatish_Reg %>%
    select(-Superority, -Aatish,-Check) %>%
    mutate(CheckType = "HC20105VsAatish",
    Group = "New Hybrid") %>%
    rename(EnvIndex = Locationmean_YLD,
    Yield = HC20105) %>%
    rbind(HC20105_Aatish_CC)
    
    


  
#Data set for Ajooba

    HC20105_Ajooba_CC <- HC20105_Ajooba_Reg %>%
    select(-Superority, -HC20105,-Check) %>%
    mutate(CheckType = "HC20105VsAjooba",
    Group     = "Check" ) %>%
    rename(EnvIndex = Locationmean_YLD,
    Yield = Ajooba)
    
    HC20105_Ajooba_NH <- HC20105_Ajooba_Reg %>%
    select(-Superority, -Ajooba,-Check) %>%
    mutate(CheckType = "HC20105VsAjooba",
    Group = "New Hybrid") %>%
    rename(EnvIndex = Locationmean_YLD,
    Yield = HC20105) %>%
    rbind(HC20105_Ajooba_CC)


#Data set for Pinaka
    
    HC20105_Pinaka_CC <- HC20105_Pinaka_Reg %>%
    select(-Superority, -HC20105,-Check) %>%
    mutate(CheckType = "HC20105VsPinaka",
    Group     = "Check" ) %>%
    rename(EnvIndex = Locationmean_YLD,
    Yield = Pinaka)
    
    HC20105_Pinaka_NH <- HC20105_Pinaka_Reg %>%
    select(-Superority, -Pinaka,-Check) %>%
    mutate(CheckType = "HC20105VsPinaka",
    Group = "New Hybrid") %>%
    rename(EnvIndex = Locationmean_YLD,
    Yield = HC20105) %>%
    rbind(HC20105_Pinaka_CC)



#Data set for MC5401
    HC20105_MC5401_CC <- HC20105_MC5401_Reg%>%
    select(-Superority, -HC20105,-Check) %>%
    mutate(CheckType = "HC20105VsMC5401",
    Group     = "Check" ) %>%
    rename(EnvIndex = Locationmean_YLD,
    Yield = MC5401)
    
    HC20105_MC5401_NH <- HC20105_MC5401_Reg %>%
    select(-Superority, -MC5401,-Check) %>%
    mutate(CheckType = "HC20105VsMC5401",
    Group = "New Hybrid") %>%
    rename(EnvIndex = Locationmean_YLD,
    Yield = HC20105) %>%
    rbind(HC20105_MC5401_CC)

    

#Data set for Vega
    HC20105_Vega_CC <- HC20105_Vega_Reg %>%
    select(-Superority, -HC20105,-Check) %>%
    mutate(CheckType = "HC20105VsVega",
    Group     = "Check" ) %>%
    rename(EnvIndex = Locationmean_YLD,
    Yield = Vega)
    
    HC20105_Vega_NH <- HC20105_Vega_Reg %>%
    select(-Superority, -Vega,-Check) %>%
    mutate(CheckType = "HC20105VsVega",
    Group = "New Hybrid") %>%
    rename(EnvIndex = Locationmean_YLD,
    Yield = HC20105) %>%
    rbind(HC20105_Vega_CC)
    
   
#Data set for RCH659
    HC20105_RCH659_CC <- HC20105_RCH659_Reg %>%
    select(-Superority, -HC20105,-Check) %>%
    mutate(CheckType = "HC20105VsRCH659",
    Group     = "Check" ) %>%
    rename(EnvIndex = Locationmean_YLD,
    Yield = RCH659)
    HC20105_RCH659_NH <- HC20105_RCH659_Reg %>%
    select(-Superority, -RCH659,-Check) %>%
    mutate(CheckType = "HC20105VsRCH659",
    Group = "New Hybrid") %>%
    rename(EnvIndex = Locationmean_YLD,
    Yield = HC20105) %>%
    rbind(HC20105_RCH659_CC)


#Data set for RCHNeo
    HC20105_RCHNeo_CC <- HC20105_RCHNeo_Reg %>%
    select(-Superority, -HC20105,-Check) %>%
    mutate(CheckType = "HC20105VsRCHNeo",
    Group     = "Check" ) %>%
    rename(EnvIndex = Locationmean_YLD,
    Yield = RCHNeo)
    
    HC20105_RCHNeo_NH <- HC20105_RCHNeo_Reg %>%
    select(-Superority, -RCHNeo,-Check) %>%
    mutate(CheckType = "HC20105VsRCHNeo",
    Group = "New Hybrid") %>%
    rename(EnvIndex = Locationmean_YLD,
    Yield = HC20105) %>%
    rbind(HC20105_RCHNeo_CC)


#Data set for Jadoo
    HC20105_Jadoo_CC <- HC20105_Jadoo_Reg %>%
    select(-Superority, -HC20105,-Check) %>%
    mutate(CheckType = "HC20105VsJadoo",
    Group     = "Check" ) %>%
    rename(EnvIndex = Locationmean_YLD,
    Yield = Jadoo)
    HC20105_Jadoo_NH <- HC20105_Jadoo_Reg %>%
    select(-Superority, -Jadoo,-Check) %>%
    mutate(CheckType = "HC20105VsJadoo",
    Group = "New Hybrid") %>%
    rename(EnvIndex = Locationmean_YLD,
    Yield = HC20105) %>%
    rbind(HC20105_Jadoo_CC)

#Data set for Moksha
    HC20105_Moksha_CC <- HC20105_Moksha_Reg %>%
    select(-Superority, -HC20105,-Check) %>%
    mutate(CheckType = "HC20105VsMoksha",
    Group     = "Check" ) %>%
    rename(EnvIndex = Locationmean_YLD,
    Yield = Moksha)
    
    HC20105_Moksha_NH <- HC20105_Moksha_Reg %>%
    select(-Superority, -Moksha,-Check) %>%
    mutate(CheckType = "HC20105VsMoksha",
    Group = "New Hybrid") %>%
    rename(EnvIndex = Locationmean_YLD,
    Yield = HC20105) %>%
    rbind(HC20105_Moksha_CC)
    

#Data set for Jangee
    HC20105_Jangee_CC <- HC20105_Jangee_Reg %>%
    select(-Superority, -HC20105,-Check) %>%
    mutate(CheckType = "HC20105VsJangee",
    Group     = "Check" ) %>%
    rename(EnvIndex = Locationmean_YLD,
    Yield = Jangee)
    
    HC20105_Jangee_NH <- HC20105_Jangee_Reg %>%
    select(-Superority, -Jangee,-Check) %>%
    mutate(CheckType = "HC20105VsJangee",
    Group = "New Hybrid") %>%
    rename(EnvIndex = Locationmean_YLD,
    Yield = HC20105) %>%
    rbind(HC20105_Jangee_CC)


#Data set for MoneyMaker
    HC20105_MoneyMaker_CC <- HC20105_MoneyMaker_Reg %>%
    select(-Superority, -HC20105,-Check) %>%
    mutate(CheckType = "HC20105VsMoneyMaker",
    Group     = "Check" ) %>%
    rename(EnvIndex = Locationmean_YLD,
    Yield = MoneyMaker)
    
    HC20105_MoneyMaker_NH <- HC20105_MoneyMaker_Reg %>%
    select(-Superority, -MoneyMaker,-Check) %>%
    mutate(CheckType = "HC20105VsMoneyMaker",
    Group = "New Hybrid") %>%
    rename(EnvIndex = Locationmean_YLD,
    Yield = HC20105) %>%
    rbind(HC20105_MoneyMaker_CC)
 
 
#Data set for ATM
    HC20105_ATM_CC <- HC20105_ATM_Reg %>%
    select(-Superority, -HC20105,-Check) %>%
    mutate(CheckType = "HC20105VsATM",
    Group     = "Check" ) %>%
    rename(EnvIndex = Locationmean_YLD,
    Yield = ATM)
    
    HC20105_ATM_NH <- HC20105_ATM_Reg %>%
    select(-Superority, -ATM,-Check) %>%
    mutate(CheckType = "HC20105VsATM",
    Group = "New Hybrid") %>%
    rename(EnvIndex = Locationmean_YLD,
    Yield = HC20105) %>%
    rbind(HC20105_ATM_CC)
    
#Comibing all the datsets created for linear regression
    HC20105_Reg <- rbind(HC20105_Aatish_NH,
    HC20105_Ajooba_NH,
    HC20105_Pinaka_NH,
    HC20105_MC5401_NH,
    HC20105_Vega_NH,
    HC20105_RCH659_NH,
    HC20105_RCHNeo_NH,
    HC20105_Jadoo_NH,
    HC20105_Moksha_NH,
    HC20105_Jangee_NH,
    HC20105_MoneyMaker_NH,
    HC20105_ATM_NH)
    
write_xlsx(list(Regresssion_data =   HC20105_Reg),
    "D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/HC20105/NH7_HC20105_Reg.xlsx") 
      
      
```

 
# 21B. Reression plots based Eberhar and Russel model HC20105 Vs Checks 

############################################################################################## 
```{r}
          
t7 <- "D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/HC20105/HC20105_Loc_Hybrid_Reg.pptx"

    my.formula <- y ~ x
    HC20105_Loc_Hybrid_Reg <- ggplot(data =  HC20105_Reg , 
                                 aes(x =  EnvIndex,
                                     y = Yield,
                                     color = Group)) +
      geom_smooth(method = "lm", se = FALSE, formula = my.formula) +
      geom_point(alpha = 0.50) +
      labs(title="Linear Regression for Measuring Stability",
           subtitle = "HC20105 vs Checks",
           x = "Environment Index", y = "Yield(kg)" ) +
      scale_color_manual(values = c("#FF4500", "#32CD32")) +
      stat_poly_eq(formula = my.formula, 
                   aes(label = paste(..eq.label.., ..rr.label.., 
                                     sep = "~~~")), 
                   label.x.npc = "left", 
                   label.y.npc = "top",
                   parse = TRUE, 
                   inherit.aes = TRUE,
                   size = 4)  +      
      facet_wrap(~CheckType, ncol = 4) +
      theme_bw() +
      theme(plot.background=element_rect(fill = "#008080"),
            panel.background = element_rect(fill = "#FAFAD2", 
                                            color = "#B8860B", size = 2),
            strip.background =element_rect(fill = "#B8860B"),
            strip.text = element_text(colour = 'white', size = 14, 
                                      face = "bold"),
            plot.title  = element_text(color = "white", size = 18,
                                       hjust = 0.50, face = "bold.italic"),
            plot.subtitle = element_text(color = "white", size = 14,
                                         hjust = 0.50, face = "bold.italic"),
            axis.title.x = element_text(color = "white", size = 14, 
                                        face = "bold"),
            axis.title.y = element_text(color = "white", size = 14, 
                                        face = "bold"),
            axis.text.x = element_text(color ="white",size=12), 
            axis.text.y = element_text(color ="white",size=12),
            panel.border = element_rect(color="darkred", size = 0.5,  
                                        linetype="solid"),
            legend.justification = c(3,0), legend.position = c(0.98,0.02))
    

    
    fig_vg7 <- dml(ggobj =   HC20105_Loc_Hybrid_Reg )
    
    read_pptx() %>% 
      add_slide(layout = "Title Only", master = "Office Theme") %>% 
      ph_with(fig_vg7, location = ph_location(left = .5, top = 1.3, height = 6, width = 10)) %>% 
      print(t7)
    
    
   fig_vg7
 
```




# 22. Barplots exhibiting Winning percentage of Hybrids  compared to Checks 
##############################################################################################

```{r}    
 #create Barplots exhibiting Mean Yield  and Winning percentage of Hybrids
      
     HC20105_barplot <-  StateHybridMeans  %>% 
      select(Hybrid_group,State,Hybrid,Type_Hybrid, Trials,Yield, Wins, Wins_PCT) %>% 
      mutate_at(vars(Wins_PCT), funs(round(., 1))) %>% 
      mutate_at(vars(Wins_PCT), funs(as.character)) %>% 
      mutate(WinsPCT = (ifelse(Hybrid == "HC20105",paste(Wins_PCT, "%", Sep = ""), 
      Wins_PCT ))) 
    
    
    t8 <- "D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/HC20105/HC20105_winsPcT.pptx"
    
    HC20105_winsPcTplot <- ggplot(data =  HC20105_barplot ,
                                  aes(x = State, y = Yield,
                                      fill = Type_Hybrid,  label = Type_Hybrid)) +
      geom_bar(stat = "identity", position = "dodge", width = 0.80) +
      facet_wrap(.~Hybrid_group, ncol = 4) +
      geom_text(aes(label = WinsPCT),
                position = position_dodge(0.50),
                angle = 90, vjust = 0.5, size = 4.0) +
      labs( title = "Winning Percentage of HC20105 over the Checks across the States ",
            x = "Sates",
            y = "Yiled(kg/acre)" ) +
      theme_minimal(base_size = 16) +
      theme( plot.title = element_text(color="coral4", size = 18, face="bold.italic", hjust = 0.5),
             strip.text = element_text( size = 12, color = "white", hjust = 0.5 ),
             strip.background = element_rect( fill = "darkgoldenrod4", color = "red"),
             panel.background = element_rect( fill = "white", color = "red"),
             panel.grid.major.y = element_line( color = "#b2b2b2" ),
             panel.grid.minor.y = element_line(),
             panel.spacing.x = unit( 1, "cm" ),
             panel.spacing.y = unit( 0.5, "cm" ),
             # legend title
             legend.title = element_text(colour="blue", size=10, 
                                      face="bold"),
             # legend labels
             legend.text = element_text(colour="blue", size=10, 
                                     face="bold"),
             legend.position =c(0.98, 0.18),
             axis.text.x=element_text(angle=45,hjust=1))
    
    fig_vg8 <- dml(ggobj =   HC20105_winsPcTplot)
    read_pptx() %>% 
      add_slide(layout = "Title Only", master = "Office Theme") %>% 
      ph_with(fig_vg8, location = ph_location(left = .5, top = 1.3, height = 6, width = 10)) %>% 
      print(t8)
   
  fig_vg8  
   
    
#########################################################################################    
``` 
 

# 23. Barplots exhibiting : Early  vs Totsl Yield for  HC20105 Vs Checks  
##############################################################################################
    
```{r}  
    All_combined_earlyYield <- All_combined %>% 
      select(Trial, State,Hybridgrp, Loc, Hybrid, Earlyyield,Yield ) %>% 
      dplyr::rename(EarlyYield = Earlyyield,
                    TotalYield = Yield) %>% 
      group_by(Trial, State,Hybridgrp, Loc, Hybrid) %>% 
      gather( Trait, Yield, -Trial,-State, -Hybridgrp, -Loc, -Hybrid)
    
    mean_earlyyield <-All_combined_earlyYield %>% 
      group_by(Trait, Hybrid, Hybridgrp) %>% 
      summarise(Mean = mean(Yield), .groups = "drop")   
    
    plot_eraly_totalyield <- ggplot(mean_earlyyield, 
                                    aes(as.factor(Trait), Mean, fill=as.factor(Hybridgrp))) + 
      geom_bar(stat = "identity", position = "dodge") + 
      facet_grid(~Hybrid) +
      geom_text(aes(label = round(Mean, 0)), 
                position = position_dodge(width = 0.9), vjust = -1)+   
      theme(strip.text.x = element_text(size=12, angle=0),
            strip.text.y = element_text(size=16,
                                        colour ="lightred",
                                        face="bold"),
            strip.background = element_rect(colour="red", fill="#CCCCFF"),
            axis.text.x=element_text(angle=45,hjust=1))+
      labs(title = "Comparision of  and Checks", size = 18 , 
           colour = "#0000FF", 
           subtitle = "Early Yield Vs  Total Fruit Yield", 
           size = 16,  colour = "#0000FF" )   
    
    # Output the Chart
    plot_eraly_totalyield        
    
##########################################################################################   
    
```   
    
    
    

    

########################################################################################
#    Analysis  of Scored Traits  for HR18304                                           #
#                                                                                      #
#    1. Standability,                                                                  #
#    2. Pickabilty                                                                 #
#    3. Stembending                                                                    #      
#    4. Suckingpest_60days                                                             #
#    5. Suckingpest_120days                                                            #
#    6. Bollworm                                                                       #
#    7. Leafcurl                                                                       #
#    8. Wiltscore                                                                      #
#                                                                                      #
#                                                                                      #
#  A Dataset for Scored Traits- Lodging and  Disease Incidence                         #
#                                                                                      #
# Dataset for Scored Traits- Lodging and  Disease Incidence:                           #
# All_combined -previously created dataset for head to head comparison All_combined    #
#                                                                                      #
#######################################################################################    
 
       
#Dataset for Scored Traits- Lodging and  Disease Incidence

```{r}

   pest_disease_data <- All_combined %>% 
     select(Trial,Hybrid_group, Hybrid, Type_Hybrid, State, District, Market, Village,                    Hybrid,Standability, Pickabilty,Stembending,Suckingpest_60days, 
            Suckingpest_120days, Bollworm,Leafcurl,Wiltscore) %>%
     mutate(across(c(Standability,  Pickabilty,Stembending,Suckingpest_60days, 
                     Suckingpest_120days, Bollworm,Leafcurl,Wiltscore),factor))
   
   
#Standability score for HC20105 and Checks
    
    Standability_Score <- pest_disease_data   %>% 
      group_by(Hybrid_group,Type_Hybrid,Hybrid, Standability) %>%
      summarise( Standability_Score = n(),.groups = "drop") %>% 
      gather(variable, value, -Hybrid_group,-Hybrid,-Type_Hybrid,-Standability) %>% 
      unite(temp, Hybrid_group,Hybrid, Type_Hybrid, variable) %>% 
      mutate(id = row_number()) %>% 
      select(-id) %>% 
      spread(temp,value)%>% 
      adorn_totals("row") %>% 
      rename_all(~str_replace_all(.,"\\_Standability_Score", "")) %>% 
     select(Standability,
            HC20105_Aatish_HC20105_NH,
            HC20105_Aatish_Aatish_CC, 
            HC20105_Ajooba_HC20105_NH,
            HC20105_Ajooba_Ajooba_CC,
            HC20105_Pinaka_HC20105_NH,
            HC20105_Pinaka_Pinaka_CC,
            HC20105_MC5401_HC20105_NH,
            HC20105_MC5401_MC5401_CC,
            HC20105_Vega_HC20105_NH,
            HC20105_Vega_Vega_CC,
            HC20105_RCH659_HC20105_NH,
            HC20105_RCH659_RCH659_CC,
            HC20105_RCHNeo_HC20105_NH,
            HC20105_RCHNeo_RCHNeo_CC,
            HC20105_Jadoo_HC20105_NH,
            HC20105_Jadoo_Jadoo_CC,
            HC20105_Moksha_HC20105_NH,
            HC20105_Moksha_Moksha_CC,
            HC20105_Jangee_HC20105_NH,
            HC20105_Jangee_Jangee_CC,
            HC20105_MoneyMaker_HC20105_NH,
            HC20105_MoneyMaker_MoneyMaker_CC,
            HC20105_ATM_HC20105_NH,
            HC20105_ATM_ATM_CC)
    
# Locations  where  severe StalkLodg score (3,4,5 scores)

Standability_Loc <- pest_disease_data   %>%
      select(Trial,State, District,Market,Village,Hybrid,Standability ) %>%
      gather(key, val, -c(Trial,State, District,Market,Village,Hybrid)) %>% 
      unite(temp, Hybrid, key) %>% 
      group_by(Trial,temp) %>% 
      mutate(ID=1:n()) %>%  
      spread(temp,val) %>% 
      distinct(Trial, .keep_all = TRUE) %>% 
      rename_all(~str_replace_all(.,"\\_Standability","")) %>% 
      select(-ID) %>% 
      distinct(Trial, .keep_all = TRUE) %>% 
      filter(HC20105 %in% c("3", "4", "5" )|
             Aatish %in% c("3", "4", "5" )|  
             Ajooba %in% c("3", "4", "5" )|
             Pinaka %in% c("3", "4", "5" )|
             MC5401 %in% c("3", "4", "5" )|  
             Vega %in% c("3", "4", "5" )|
             RCH659 %in% c("3", "4", "5" )|
             RCHNeo %in% c("3", "4", "5" )|  
             Jadoo %in% c("3", "4", "5" )|
             Moksha %in% c("3", "4", "5" )|
             Jangee %in% c("3", "4", "5" )|  
             MoneyMaker %in% c("3", "4", "5" )|
             ATM %in% c("3", "4", "5" )) %>% 
      select(Trial,State, District,Market,Village,HC20105,Aatish,Ajooba, Pinaka, MC5401, Vega,
              RCH659,RCHNeo,Jadoo, Moksha, Jangee, MoneyMaker, ATM)
    
    write_xlsx(list(Standability_Score  =   Standability_Score ,
                    Standability_Loc =  Standability_Loc),
      "D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/HC20105/NH10_HC20105_Standability.xlsx")
 

    
# Pickabilty score for HC20105 and Checks
    

  Pickabilty_Score <- pest_disease_data   %>% 
      group_by(Hybrid_group,Type_Hybrid,Hybrid, Pickabilty) %>%
      summarise( Pickabilty_Score = n(),.groups = "drop") %>% 
      gather(variable, value, -Hybrid_group,-Hybrid,-Type_Hybrid,-Pickabilty) %>% 
      unite(temp, Hybrid_group,Hybrid, Type_Hybrid, variable) %>% 
      mutate(id = row_number()) %>% 
      select(-id) %>% 
      spread(temp,value)%>% 
      adorn_totals("row") %>% 
      rename_all(~str_replace_all(.,"\\_Pickabilty_Score", "")) %>% 
       rename_all(~str_replace_all(.,"\\_Standability_Score", "")) %>% 
     select(Pickabilty,
            HC20105_Aatish_HC20105_NH,
            HC20105_Aatish_Aatish_CC, 
            HC20105_Ajooba_HC20105_NH,
            HC20105_Ajooba_Ajooba_CC,
            HC20105_Pinaka_HC20105_NH,
            HC20105_Pinaka_Pinaka_CC,
            HC20105_MC5401_HC20105_NH,
            HC20105_MC5401_MC5401_CC,
            HC20105_Vega_HC20105_NH,
            HC20105_Vega_Vega_CC,
            HC20105_RCH659_HC20105_NH,
            HC20105_RCH659_RCH659_CC,
            HC20105_RCHNeo_HC20105_NH,
            HC20105_RCHNeo_RCHNeo_CC,
            HC20105_Jadoo_HC20105_NH,
            HC20105_Jadoo_Jadoo_CC,
            HC20105_Moksha_HC20105_NH,
            HC20105_Moksha_Moksha_CC,
            HC20105_Jangee_HC20105_NH,
            HC20105_Jangee_Jangee_CC,
            HC20105_MoneyMaker_HC20105_NH,
            HC20105_MoneyMaker_MoneyMaker_CC,
            HC20105_ATM_HC20105_NH,
            HC20105_ATM_ATM_CC)
    
# Locations  where  severe StalkLodg score (3,4,5 scores)
    
    

  
    Pickabilty_Loc <- pest_disease_data   %>%
      select(Trial,State, District,Market,Village,Hybrid,Pickabilty ) %>%
      gather(key, val, -c(Trial,State, District,Market,Village,Hybrid)) %>% 
      unite(temp, Hybrid, key) %>% 
      group_by(Trial,temp) %>% 
      mutate(ID=1:n()) %>%  
      spread(temp,val) %>% 
      distinct(Trial, .keep_all = TRUE) %>% 
      rename_all(~str_replace_all(.,"\\_Pickabilty","")) %>% 
      select(-ID) %>% 
      distinct(Trial, .keep_all = TRUE) %>% 
      filter(HC20105 %in% c("3", "4", "5" )|
             Aatish %in% c("3", "4", "5" )|  
             Ajooba %in% c("3", "4", "5" )|
             Pinaka %in% c("3", "4", "5" )|
             MC5401 %in% c("3", "4", "5" )|  
             Vega %in% c("3", "4", "5" )|
             RCH659 %in% c("3", "4", "5" )|
             RCHNeo %in% c("3", "4", "5" )|  
             Jadoo %in% c("3", "4", "5" )|
             Moksha %in% c("3", "4", "5" )|
             Jangee %in% c("3", "4", "5" )|  
             MoneyMaker %in% c("3", "4", "5" )|
             ATM %in% c("3", "4", "5" )) %>% 
      select(Trial,State, District,Market,Village,HC20105,Aatish,Ajooba, Pinaka, MC5401, Vega,
              RCH659,RCHNeo,Jadoo, Moksha, Jangee, MoneyMaker, ATM)
    write_xlsx(list( Pickabilty_Score  =   Pickabilty_Score ,
                     Pickabilty_Loc =  Pickabilty_Loc),
               "D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/HC20105/NH11_HC20105_Pickabilty.xlsx")
    
    
    
#Stembending score for HC20105 and Checks
    

    
    Stembending_Score <- pest_disease_data   %>% 
      group_by(Hybrid_group,Type_Hybrid,Hybrid, Stembending) %>%
      summarise( Stembending_Score = n(),.groups = "drop") %>% 
      gather(variable, value, -Hybrid_group,-Hybrid,-Type_Hybrid,-Stembending) %>% 
      unite(temp, Hybrid_group,Hybrid, Type_Hybrid, variable) %>% 
      mutate(id = row_number()) %>% 
      select(-id) %>% 
      spread(temp,value)%>% 
      adorn_totals("row") %>% 
      rename_all(~str_replace_all(.,"\\_Stembending_Score", "")) %>% 
      rename_all(~str_replace_all(.,"\\_Standability_Score", "")) %>% 
     select(Stembending,
            HC20105_Aatish_HC20105_NH,
            HC20105_Aatish_Aatish_CC, 
            HC20105_Ajooba_HC20105_NH,
            HC20105_Ajooba_Ajooba_CC,
            HC20105_Pinaka_HC20105_NH,
            HC20105_Pinaka_Pinaka_CC,
            HC20105_MC5401_HC20105_NH,
            HC20105_MC5401_MC5401_CC,
            HC20105_Vega_HC20105_NH,
            HC20105_Vega_Vega_CC,
            HC20105_RCH659_HC20105_NH,
            HC20105_RCH659_RCH659_CC,
            HC20105_RCHNeo_HC20105_NH,
            HC20105_RCHNeo_RCHNeo_CC,
            HC20105_Jadoo_HC20105_NH,
            HC20105_Jadoo_Jadoo_CC,
            HC20105_Moksha_HC20105_NH,
            HC20105_Moksha_Moksha_CC,
            HC20105_Jangee_HC20105_NH,
            HC20105_Jangee_Jangee_CC,
            HC20105_MoneyMaker_HC20105_NH,
            HC20105_MoneyMaker_MoneyMaker_CC,
            HC20105_ATM_HC20105_NH,
            HC20105_ATM_ATM_CC)
    
# Locations  where  severe StalkLodg score (3,4,5 scores)
    
    Stembending_Loc <- pest_disease_data   %>%
      select(Trial,State, District,Market,Village,Hybrid,Stembending ) %>%
      gather(key, val, -c(Trial,State, District,Market,Village,Hybrid)) %>% 
      unite(temp, Hybrid, key) %>% 
      group_by(Trial,temp) %>% 
      mutate(ID=1:n()) %>%  
      spread(temp,val) %>% 
      distinct(Trial, .keep_all = TRUE) %>% 
      rename_all(~str_replace_all(.,"\\_Stembending","")) %>% 
      select(-ID) %>% 
      distinct(Trial, .keep_all = TRUE) %>% 
      filter(HC20105 %in% c("3", "4", "5" )|
             Aatish %in% c("3", "4", "5" )|  
             Ajooba %in% c("3", "4", "5" )|
             Pinaka %in% c("3", "4", "5" )|
             MC5401 %in% c("3", "4", "5" )|  
             Vega %in% c("3", "4", "5" )|
             RCH659 %in% c("3", "4", "5" )|
             RCHNeo %in% c("3", "4", "5" )|  
             Jadoo %in% c("3", "4", "5" )|
             Moksha %in% c("3", "4", "5" )|
             Jangee %in% c("3", "4", "5" )|  
             MoneyMaker %in% c("3", "4", "5" )|
             ATM %in% c("3", "4", "5" )) %>% 
      select(Trial,State, District,Market,Village,HC20105,Aatish,Ajooba, Pinaka, MC5401, Vega,
              RCH659,RCHNeo,Jadoo, Moksha, Jangee, MoneyMaker, ATM)
    
    write_xlsx(list(Stembending_Score =   Stembending_Score ,
                    Stembending_Loc =  Stembending_Loc),
               "D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/HC20105/NH12_HC20105_Stembending.xlsx")
    

#Suckingpest_60days score for HC20105 and Checks
    
      Suckingpest_60days_Score <- pest_disease_data   %>% 
      group_by(Hybrid_group,Type_Hybrid,Hybrid, Suckingpest_60days) %>%
      summarise( Suckingpest_60days_Score = n(),.groups = "drop") %>% 
      gather(variable, value, -Hybrid_group,-Hybrid,-Type_Hybrid,-Suckingpest_60days) %>% 
      unite(temp, Hybrid_group,Hybrid, Type_Hybrid, variable) %>% 
      mutate(id = row_number()) %>% 
      select(-id) %>% 
      spread(temp,value)%>% 
      adorn_totals("row") %>% 
      rename_all(~str_replace_all(.,"\\_Suckingpest_60days_Score", "")) %>% 
       rename_all(~str_replace_all(.,"\\_Standability_Score", "")) %>% 
     select(Suckingpest_60days,
            HC20105_Aatish_HC20105_NH,
            HC20105_Aatish_Aatish_CC, 
            HC20105_Ajooba_HC20105_NH,
            HC20105_Ajooba_Ajooba_CC,
            HC20105_Pinaka_HC20105_NH,
            HC20105_Pinaka_Pinaka_CC,
            HC20105_MC5401_HC20105_NH,
            HC20105_MC5401_MC5401_CC,
            HC20105_Vega_HC20105_NH,
            HC20105_Vega_Vega_CC,
            HC20105_RCH659_HC20105_NH,
            HC20105_RCH659_RCH659_CC,
            HC20105_RCHNeo_HC20105_NH,
            HC20105_RCHNeo_RCHNeo_CC,
            HC20105_Jadoo_HC20105_NH,
            HC20105_Jadoo_Jadoo_CC,
            HC20105_Moksha_HC20105_NH,
            HC20105_Moksha_Moksha_CC,
            HC20105_Jangee_HC20105_NH,
            HC20105_Jangee_Jangee_CC,
            HC20105_MoneyMaker_HC20105_NH,
            HC20105_MoneyMaker_MoneyMaker_CC,
            HC20105_ATM_HC20105_NH,
            HC20105_ATM_ATM_CC)

# Locations  where  severe StalkLodg score (3,4,5 scores)
    
    Suckingpest_60days_Loc <- pest_disease_data   %>%
      select(Trial,State, District,Market,Village,Hybrid,Suckingpest_60days ) %>%
      gather(key, val, -c(Trial,State, District,Market,Village,Hybrid)) %>% 
      unite(temp, Hybrid, key) %>% 
      group_by(Trial,temp) %>% 
      mutate(ID=1:n()) %>%  
      spread(temp,val) %>% 
      distinct(Trial, .keep_all = TRUE) %>% 
      rename_all(~str_replace_all(.,"\\_Suckingpest_60days","")) %>% 
      select(-ID) %>% 
      distinct(Trial, .keep_all = TRUE) %>% 
    filter(HC20105 %in% c("3", "4", "5" )|
             Aatish %in% c("3", "4", "5" )|  
             Ajooba %in% c("3", "4", "5" )|
             Pinaka %in% c("3", "4", "5" )|
             MC5401 %in% c("3", "4", "5" )|  
             Vega %in% c("3", "4", "5" )|
             RCH659 %in% c("3", "4", "5" )|
             RCHNeo %in% c("3", "4", "5" )|  
             Jadoo %in% c("3", "4", "5" )|
             Moksha %in% c("3", "4", "5" )|
             Jangee %in% c("3", "4", "5" )|  
             MoneyMaker %in% c("3", "4", "5" )|
             ATM %in% c("3", "4", "5" )) %>% 
      select(Trial,State, District,Market,Village,HC20105,Aatish,Ajooba, Pinaka, MC5401, Vega,
              RCH659,RCHNeo,Jadoo, Moksha, Jangee, MoneyMaker, ATM)
    
    write_xlsx(list(Suckingpest_60days_Score  =   Suckingpest_60days_Score ,
                    Suckingpest_60days_Loc =  Suckingpest_60days_Loc),
               "D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/HC20105/NH13_HC20105_Suckingpest_60days.xlsx")
    
    
    
    
#Suckingpest_120days score for HC20105 and Checks
    
    
    Suckingpest_120days_Score <- pest_disease_data   %>% 
      group_by(Hybrid_group,Type_Hybrid,Hybrid, Suckingpest_120days) %>%
      summarise( Suckingpest_120days_Score = n(),.groups = "drop") %>% 
      gather(variable, value, -Hybrid_group,-Hybrid,-Type_Hybrid,-Suckingpest_120days) %>% 
      unite(temp, Hybrid_group,Hybrid, Type_Hybrid, variable) %>% 
      mutate(id = row_number()) %>% 
      select(-id) %>% 
      spread(temp,value)%>% 
      adorn_totals("row") %>% 
      rename_all(~str_replace_all(.,"\\_Suckingpest_120days_Score", "")) %>% 
      rename_all(~str_replace_all(.,"\\_Standability_Score", "")) %>% 
     select(Suckingpest_120days,
            HC20105_Aatish_HC20105_NH,
            HC20105_Aatish_Aatish_CC, 
            HC20105_Ajooba_HC20105_NH,
            HC20105_Ajooba_Ajooba_CC,
            HC20105_Pinaka_HC20105_NH,
            HC20105_Pinaka_Pinaka_CC,
            HC20105_MC5401_HC20105_NH,
            HC20105_MC5401_MC5401_CC,
            HC20105_Vega_HC20105_NH,
            HC20105_Vega_Vega_CC,
            HC20105_RCH659_HC20105_NH,
            HC20105_RCH659_RCH659_CC,
            HC20105_RCHNeo_HC20105_NH,
            HC20105_RCHNeo_RCHNeo_CC,
            HC20105_Jadoo_HC20105_NH,
            HC20105_Jadoo_Jadoo_CC,
            HC20105_Moksha_HC20105_NH,
            HC20105_Moksha_Moksha_CC,
            HC20105_Jangee_HC20105_NH,
            HC20105_Jangee_Jangee_CC,
            HC20105_MoneyMaker_HC20105_NH,
            HC20105_MoneyMaker_MoneyMaker_CC,
            HC20105_ATM_HC20105_NH,
            HC20105_ATM_ATM_CC)
    
# Locations  where  severe StalkLodg score (3,4,5 scores)
    
    Suckingpest_120days_Loc <- pest_disease_data   %>%
      select(Trial,State, District,Market,Village,Hybrid,Suckingpest_120days ) %>%
      gather(key, val, -c(Trial,State, District,Market,Village,Hybrid)) %>% 
      unite(temp, Hybrid, key) %>% 
      group_by(Trial,temp) %>% 
      mutate(ID=1:n()) %>%  
      spread(temp,val) %>% 
      distinct(Trial, .keep_all = TRUE) %>% 
      rename_all(~str_replace_all(.,"\\_Suckingpest_120days","")) %>% 
      select(-ID) %>% 
      distinct(Trial, .keep_all = TRUE) %>% 
      filter(HC20105 %in% c("3", "4", "5" )|
             Aatish %in% c("3", "4", "5" )|  
             Ajooba %in% c("3", "4", "5" )|
             Pinaka %in% c("3", "4", "5" )|
             MC5401 %in% c("3", "4", "5" )|  
             Vega %in% c("3", "4", "5" )|
             RCH659 %in% c("3", "4", "5" )|
             RCHNeo %in% c("3", "4", "5" )|  
             Jadoo %in% c("3", "4", "5" )|
             Moksha %in% c("3", "4", "5" )|
             Jangee %in% c("3", "4", "5" )|  
             MoneyMaker %in% c("3", "4", "5" )|
             ATM %in% c("3", "4", "5" )) %>% 
      select(Trial,State, District,Market,Village,HC20105,Aatish,Ajooba, Pinaka, MC5401, Vega,
              RCH659,RCHNeo,Jadoo, Moksha, Jangee, MoneyMaker, ATM)
    
    write_xlsx(list(Suckingpest_120days  =   Suckingpest_120days_Score ,
                    Suckingpest_120days_Loc=  Suckingpest_120days_Loc),
               "D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/HC20105/NH14_HC20105_Suckingpest_120days.xlsx")
    
    
    
#Bollworm score for HC20105 and Checks
    
    Bollworm_Score <- pest_disease_data   %>% 
      group_by(Hybrid_group,Type_Hybrid,Hybrid, Bollworm) %>%
      summarise( Bollworm_Score = n(),.groups = "drop") %>% 
      gather(variable, value, -Hybrid_group,-Hybrid,-Type_Hybrid,-Bollworm) %>% 
      unite(temp, Hybrid_group,Hybrid, Type_Hybrid, variable) %>% 
      mutate(id = row_number()) %>% 
      select(-id) %>% 
      spread(temp,value)%>% 
      adorn_totals("row") %>% 
      rename_all(~str_replace_all(.,"\\_Bollworm_Score", "")) %>% 
      rename_all(~str_replace_all(.,"\\_Standability_Score", "")) %>% 
     select( Bollworm,
            HC20105_Aatish_HC20105_NH,
            HC20105_Aatish_Aatish_CC, 
            HC20105_Ajooba_HC20105_NH,
            HC20105_Ajooba_Ajooba_CC,
            HC20105_Pinaka_HC20105_NH,
            HC20105_Pinaka_Pinaka_CC,
            HC20105_MC5401_HC20105_NH,
            HC20105_MC5401_MC5401_CC,
            HC20105_Vega_HC20105_NH,
            HC20105_Vega_Vega_CC,
            HC20105_RCH659_HC20105_NH,
            HC20105_RCH659_RCH659_CC,
            HC20105_RCHNeo_HC20105_NH,
            HC20105_RCHNeo_RCHNeo_CC,
            HC20105_Jadoo_HC20105_NH,
            HC20105_Jadoo_Jadoo_CC,
            HC20105_Moksha_HC20105_NH,
            HC20105_Moksha_Moksha_CC,
            HC20105_Jangee_HC20105_NH,
            HC20105_Jangee_Jangee_CC,
            HC20105_MoneyMaker_HC20105_NH,
            HC20105_MoneyMaker_MoneyMaker_CC,
            HC20105_ATM_HC20105_NH,
            HC20105_ATM_ATM_CC)
    
# Locations  where  severe StalkLodg score (3,4,5 scores)
    
    Bollworm_Loc <- pest_disease_data   %>%
      select(Trial,State, District,Market,Village,Hybrid,Bollworm ) %>%
      gather(key, val, -c(Trial,State, District,Market,Village,Hybrid)) %>% 
      unite(temp, Hybrid, key) %>% 
      group_by(Trial,temp) %>% 
      mutate(ID=1:n()) %>%  
      spread(temp,val) %>% 
      distinct(Trial, .keep_all = TRUE) %>% 
      rename_all(~str_replace_all(.,"\\_Bollworm","")) %>% 
      select(-ID) %>% 
      distinct(Trial, .keep_all = TRUE) %>% 
      filter(HC20105 %in% c("3", "4", "5" )|
             Aatish %in% c("3", "4", "5" )|  
             Ajooba %in% c("3", "4", "5" )|
             Pinaka %in% c("3", "4", "5" )|
             MC5401 %in% c("3", "4", "5" )|  
             Vega %in% c("3", "4", "5" )|
             RCH659 %in% c("3", "4", "5" )|
             RCHNeo %in% c("3", "4", "5" )|  
             Jadoo %in% c("3", "4", "5" )|
             Moksha %in% c("3", "4", "5" )|
             Jangee %in% c("3", "4", "5" )|  
             MoneyMaker %in% c("3", "4", "5" )|
             ATM %in% c("3", "4", "5" )) %>% 
      select(Trial,State, District,Market,Village,HC20105,Aatish,Ajooba, Pinaka, MC5401, Vega,
              RCH659,RCHNeo,Jadoo, Moksha, Jangee, MoneyMaker, ATM)
    write_xlsx(list( Bollworm  =   Bollworm_Score ,
                     Bollworm_loc =  Bollworm_Loc),
               "D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/HC20105/NH15_HC20105_Bollworm.xlsx")
    
    

    
#Leafcurl score for HC20105 and Checks
    
    
    Leafcurl_Score <- pest_disease_data   %>% 
      group_by(Hybrid_group,Type_Hybrid,Hybrid, Leafcurl) %>%
      summarise( Leafcurl_Score = n(),.groups = "drop") %>% 
      gather(variable, value, -Hybrid_group,-Hybrid,-Type_Hybrid,-Leafcurl) %>% 
      unite(temp, Hybrid_group,Hybrid, Type_Hybrid, variable) %>% 
      mutate(id = row_number()) %>% 
      select(-id) %>% 
      spread(temp,value)%>% 
      adorn_totals("row") %>% 
      rename_all(~str_replace_all(.,"\\_Leafcurl_Score", "")) %>% 
      rename_all(~str_replace_all(.,"\\_Standability_Score", "")) %>% 
     select(Leafcurl,
            HC20105_Aatish_HC20105_NH,
            HC20105_Aatish_Aatish_CC, 
            HC20105_Ajooba_HC20105_NH,
            HC20105_Ajooba_Ajooba_CC,
            HC20105_Pinaka_HC20105_NH,
            HC20105_Pinaka_Pinaka_CC,
            HC20105_MC5401_HC20105_NH,
            HC20105_MC5401_MC5401_CC,
            HC20105_Vega_HC20105_NH,
            HC20105_Vega_Vega_CC,
            HC20105_RCH659_HC20105_NH,
            HC20105_RCH659_RCH659_CC,
            HC20105_RCHNeo_HC20105_NH,
            HC20105_RCHNeo_RCHNeo_CC,
            HC20105_Jadoo_HC20105_NH,
            HC20105_Jadoo_Jadoo_CC,
            HC20105_Moksha_HC20105_NH,
            HC20105_Moksha_Moksha_CC,
            HC20105_Jangee_HC20105_NH,
            HC20105_Jangee_Jangee_CC,
            HC20105_MoneyMaker_HC20105_NH,
            HC20105_MoneyMaker_MoneyMaker_CC,
            HC20105_ATM_HC20105_NH,
            HC20105_ATM_ATM_CC)
    
# Locations  where  severe StalkLodg score (3,4,5 scores)
    
    Leafcurl_Loc <- pest_disease_data   %>%
      select(Trial,State, District,Market,Village,Hybrid,Leafcurl ) %>%
      gather(key, val, -c(Trial,State, District,Market,Village,Hybrid)) %>% 
      unite(temp, Hybrid, key) %>% 
      group_by(Trial,temp) %>% 
      mutate(ID=1:n()) %>%  
      spread(temp,val) %>% 
      distinct(Trial, .keep_all = TRUE) %>% 
      rename_all(~str_replace_all(.,"\\_Leafcurl","")) %>% 
      select(-ID) %>% 
      distinct(Trial, .keep_all = TRUE) %>% 
       filter(HC20105 %in% c("3", "4", "5" )|
             Aatish %in% c("3", "4", "5" )|  
             Ajooba %in% c("3", "4", "5" )|
             Pinaka %in% c("3", "4", "5" )|
             MC5401 %in% c("3", "4", "5" )|  
             Vega %in% c("3", "4", "5" )|
             RCH659 %in% c("3", "4", "5" )|
             RCHNeo %in% c("3", "4", "5" )|  
             Jadoo %in% c("3", "4", "5" )|
             Moksha %in% c("3", "4", "5" )|
             Jangee %in% c("3", "4", "5" )|  
             MoneyMaker %in% c("3", "4", "5" )|
             ATM %in% c("3", "4", "5" )) %>% 
      select(Trial,State, District,Market,Village,HC20105,Aatish,Ajooba, Pinaka, MC5401, Vega,
              RCH659,RCHNeo,Jadoo, Moksha, Jangee, MoneyMaker, ATM)
              
    write_xlsx(list(Leafcurl_Score  =   Leafcurl_Score ,
                    Leafcurl_Loc =  Leafcurl_Loc),
               "D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/HC20105/NH16_HC20105_Leafcurl.xlsx")
    
    
    
#Wiltscore score for HC20105 and Checks
    
    
    Wiltscore_Score <- pest_disease_data   %>% 
      group_by(Hybrid_group,Type_Hybrid,Hybrid, Wiltscore) %>%
      summarise( Wiltscore_Score = n(),.groups = "drop") %>% 
      gather(variable, value, -Hybrid_group,-Hybrid,-Type_Hybrid,-Wiltscore) %>% 
      unite(temp, Hybrid_group,Hybrid, Type_Hybrid, variable) %>% 
      mutate(id = row_number()) %>% 
      select(-id) %>% 
      spread(temp,value)%>% 
      adorn_totals("row") %>% 
      rename_all(~str_replace_all(.,"\\_Wiltscore_Score", "")) %>% 
      rename_all(~str_replace_all(.,"\\_Standability_Score", "")) %>% 
     select(Wiltscore,
            HC20105_Aatish_HC20105_NH,
            HC20105_Aatish_Aatish_CC, 
            HC20105_Ajooba_HC20105_NH,
            HC20105_Ajooba_Ajooba_CC,
            HC20105_Pinaka_HC20105_NH,
            HC20105_Pinaka_Pinaka_CC,
            HC20105_MC5401_HC20105_NH,
            HC20105_MC5401_MC5401_CC,
            HC20105_Vega_HC20105_NH,
            HC20105_Vega_Vega_CC,
            HC20105_RCH659_HC20105_NH,
            HC20105_RCH659_RCH659_CC,
            HC20105_RCHNeo_HC20105_NH,
            HC20105_RCHNeo_RCHNeo_CC,
            HC20105_Jadoo_HC20105_NH,
            HC20105_Jadoo_Jadoo_CC,
            HC20105_Moksha_HC20105_NH,
            HC20105_Moksha_Moksha_CC,
            HC20105_Jangee_HC20105_NH,
            HC20105_Jangee_Jangee_CC,
            HC20105_MoneyMaker_HC20105_NH,
            HC20105_MoneyMaker_MoneyMaker_CC,
            HC20105_ATM_HC20105_NH,
            HC20105_ATM_ATM_CC)
    
# Locations  where  severe StalkLodg score (3,4,5 scores)
    
    Wiltscore_Loc <- pest_disease_data   %>%
      select(Trial,State, District,Market,Village,Hybrid,Wiltscore ) %>%
      gather(key, val, -c(Trial,State, District,Market,Village,Hybrid)) %>% 
      unite(temp, Hybrid, key) %>% 
      group_by(Trial,temp) %>% 
      mutate(ID=1:n()) %>%  
      spread(temp,val) %>% 
      distinct(Trial, .keep_all = TRUE) %>% 
      rename_all(~str_replace_all(.,"\\_Wiltscore","")) %>% 
      select(-ID) %>% 
      distinct(Trial, .keep_all = TRUE) %>% 
     filter(HC20105 %in% c("3", "4", "5" )|
             Aatish %in% c("3", "4", "5" )|  
             Ajooba %in% c("3", "4", "5" )|
             Pinaka %in% c("3", "4", "5" )|
             MC5401 %in% c("3", "4", "5" )|  
             Vega %in% c("3", "4", "5" )|
             RCH659 %in% c("3", "4", "5" )|
             RCHNeo %in% c("3", "4", "5" )|  
             Jadoo %in% c("3", "4", "5" )|
             Moksha %in% c("3", "4", "5" )|
             Jangee %in% c("3", "4", "5" )|  
             MoneyMaker %in% c("3", "4", "5" )|
             ATM %in% c("3", "4", "5" )) %>% 
      select(Trial,State, District,Market,Village,HC20105,Aatish,Ajooba, Pinaka, MC5401, Vega,
              RCH659,RCHNeo,Jadoo, Moksha, Jangee, MoneyMaker, ATM)
    
    write_xlsx(list(StalkLodgScore  =   Wiltscore_Score ,
                    SevereStalkLodgLoc =  Wiltscore_Loc),
               "D:/ProductDevelopment/R_Projects/Cotton/cotton_SC/HAT/Results/HC20105/NH17_HC20105_Wiltscore.xlsx")
```   
    
#######################################################################################
#    
#  Creating Radar Graphs 
#    - Libraries used: library(ggradar), library(scales) and library(dplyr)
#    - Preparation of data 
#    -  combining the datasets 
######################################################################################   
    
``` {r}
    library(ggradar2)
    library(ggradar)
    
 



    HybridMeans_radar <- HybridMeans %>% 
      arrange(Hybrid_group, Hybrid)
    
    HybridMeans_score_traits_radar <- HybridMeans_score_traits %>% 
      arrange(Hybrid_group, Hybrid)
    
    agron_quality_diseaes_HC20105 <- cbind(HybridMeans_radar,  
                                           HybridMeans_score_traits_radar) %>% 
      select(1,2,3,6,7,8,12,14,23:29) %>% 
      mutate(Hybrid_group  = str_remove(Hybrid_group ,
                                        "HC20105_")) %>% 
      arrange(Hybrid_group, desc(Type_Hybrid)) %>% 
      dplyr::rename("Monopodials" = "Monopodials",
                    "Sympodials" = "Sympodials",
                    "Bollweight" = "Bollweight",
                    "Yield" = "Yield",
                    "Standability" = "Standability",
                    "Pickabilty" = "Pickabilty",
                    "Suckingpest_60days" = "Suckingpest_60days",
                    "Suckingpest-120days" = "Suckingpest-120days",
                    "Bollworm" = "Bollworm",
                    "Leafcurl" = "Leafcurl",
                    "Wiltscore" = "Wiltscore") %>% 
      select(-2)                                                                                     
     

# Creating Variable should be called group

group <- c("HC20105_Aatish", "Aatish",
           "HC20105_Ajooba", "Ajooba",
           "HC20105_ATM", "ATM",
           "HC20105_Jadoo", "Jadoo",
           "HC20105_Jangee", "Jangee",
           "HC20105_MC5401", "MC5401",           
           "HC20105_Moksha", "Moksha",
           "HC20105_MoneyMaker", "MoneyMaker",
           "HC20105_Pinaka", "Pinaka",
           "HC20105_RCH659", "RCH659",
           "HC20105_RCHNeo", "RCHNeo",
           "HC20105_Vega", "Vega")

# Assigning  the the group varaible  to agron_quality_diseaes_HT20404

agron_quality_diseaes_HC20105$Hybrid <- group

# Deleting  the variables, hyb_group and Wins

radartest <- agron_quality_diseaes_HC20105 %>% 
  select(-Hybrid_group) %>% 
  dplyr::rename(group = Hybrid)



radar_HC20105plot <- ggradar2(radartest,
                              grid.label.size = 4,
                              axis.label.size = 4, 
                              group.point.size = 5,
                              group.line.width = 1.5,
                              legend.text.size= 10) +
  labs(title = "Radar Chart comparing HC20105 with Checks") 



#Multiple plots by subgroups

facet1 <- agron_quality_diseaes_HC20105$Hybrid_group        
radartest2 <- cbind(radartest,facet1) 

radar_HC20105plot1 <- ggradar2(  radartest2 ,
                                 multiplots = TRUE,
                                 grid.label.size = 3,
                                 axis.label.size = 2, 
                                 group.point.size = 5,
                                 group.line.width = 1,
                                 legend.text.size = 12) %>% 
  labs(title = "Radar Chart comparing HC20105 with Checks") 





radartest2_2  <- radartest2[c(1,2,3,4,5,6,7,8,9,10,12),]

radar_HT20404plot2 <- ggradar2(radartest2_2,
                               multiplots = TRUE,
                               grid.label.size = 5,
                               axis.label.size = 3, 
                               group.point.size = 5,
                               group.line.width = 1,
                               legend.text.size = 16) %>% 
  labs(title = "Radar Chart comparing HC20105 with Checks") 


radartest2_3  <- radartest2[c(13,14,15,16,17,18,19,20,21,22,24),]

radar_HT20404plot3 <- ggradar2(radartest2_3,
                               multiplots = TRUE,
                               grid.label.size = 3,
                               axis.label.size = 3, 
                               group.point.size = 5,
                               group.line.width = 1,
                               legend.text.size = 14) %>% 
  labs(title = "Radar Chart comparing HC20105 with Checks") 

````

radar_HT20404plot2

radar_HC20105plot


radar_HT20404plot3
